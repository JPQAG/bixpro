{"ast":null,"code":"'use strict'; //  ---------------------------------------------------------------------------\n\nconst Exchange = require('./base/Exchange');\n\nconst {\n  TICK_SIZE\n} = require('./base/functions/number');\n\nconst {\n  ExchangeError,\n  InvalidOrder,\n  BadRequest,\n  InsufficientFunds,\n  OrderNotFound,\n  AuthenticationError,\n  RateLimitExceeded,\n  ExchangeNotAvailable,\n  CancelPending,\n  ArgumentsRequired,\n  PermissionDenied,\n  BadSymbol,\n  DuplicateOrderId\n} = require('./base/errors');\n\nconst Precise = require('./base/Precise'); //  ---------------------------------------------------------------------------\n\n\nmodule.exports = class ftx extends Exchange {\n  describe() {\n    return this.deepExtend(super.describe(), {\n      'id': 'ftx',\n      'name': 'FTX',\n      'countries': ['HK'],\n      'rateLimit': 50,\n      'certified': true,\n      'pro': true,\n      'hostname': 'ftx.com',\n      // or ftx.us\n      'urls': {\n        'logo': 'https://user-images.githubusercontent.com/1294454/67149189-df896480-f2b0-11e9-8816-41593e17f9ec.jpg',\n        'www': 'https://ftx.com',\n        'api': {\n          'public': 'https://{hostname}',\n          'private': 'https://{hostname}'\n        },\n        'doc': 'https://github.com/ftexchange/ftx',\n        'fees': 'https://ftexchange.zendesk.com/hc/en-us/articles/360024479432-Fees',\n        'referral': 'https://ftx.com/#a=1623029'\n      },\n      'has': {\n        'cancelAllOrders': true,\n        'cancelOrder': true,\n        'createOrder': true,\n        'editOrder': true,\n        'fetchBalance': true,\n        'fetchClosedOrders': false,\n        'fetchCurrencies': true,\n        'fetchDepositAddress': true,\n        'fetchDeposits': true,\n        'fetchFundingFees': false,\n        'fetchMarkets': true,\n        'fetchMyTrades': true,\n        'fetchOHLCV': true,\n        'fetchOpenOrders': true,\n        'fetchOrder': true,\n        'fetchOrderBook': true,\n        'fetchOrders': true,\n        'fetchPositions': true,\n        'fetchTicker': true,\n        'fetchTickers': true,\n        'fetchTrades': true,\n        'fetchTradingFees': true,\n        'fetchWithdrawals': true,\n        'withdraw': true\n      },\n      'timeframes': {\n        '15s': '15',\n        '1m': '60',\n        '5m': '300',\n        '15m': '900',\n        '1h': '3600',\n        '4h': '14400',\n        '1d': '86400'\n      },\n      'api': {\n        'public': {\n          'get': ['coins', 'markets', 'markets/{market_name}', 'markets/{market_name}/orderbook', // ?depth={depth}\n          'markets/{market_name}/trades', // ?limit={limit}&start_time={start_time}&end_time={end_time}\n          'markets/{market_name}/candles', // ?resolution={resolution}&limit={limit}&start_time={start_time}&end_time={end_time}\n          // futures\n          'futures', 'futures/{future_name}', 'futures/{future_name}/stats', 'funding_rates', 'indexes/{index_name}/weights', 'expired_futures', 'indexes/{market_name}/candles', // ?resolution={resolution}&limit={limit}&start_time={start_time}&end_time={end_time}\n          // leverage tokens\n          'lt/tokens', 'lt/{token_name}', // options\n          'options/requests', 'options/trades', 'stats/24h_options_volume', 'options/historical_volumes/BTC', 'options/open_interest/BTC', 'options/historical_open_interest/BTC', // spot margin\n          'spot_margin/history']\n        },\n        'private': {\n          'get': ['account', 'positions', 'wallet/coins', 'wallet/balances', 'wallet/all_balances', 'wallet/deposit_address/{coin}', // ?method={method}\n          'wallet/deposits', 'wallet/withdrawals', 'wallet/withdrawal_fee', 'wallet/airdrops', 'wallet/saved_addresses', 'orders', // ?market={market}\n          'orders/history', // ?market={market}\n          'orders/{order_id}', 'orders/by_client_id/{client_order_id}', 'conditional_orders', // ?market={market}\n          'conditional_orders/{conditional_order_id}/triggers', 'conditional_orders/history', // ?market={market}\n          'spot_margin/borrow_rates', 'spot_margin/lending_rates', 'spot_margin/borrow_summary', 'spot_margin/market_info', // ?market={market}\n          'spot_margin/borrow_history', 'spot_margin/lending_history', 'spot_margin/offers', 'spot_margin/lending_info', 'fills', // ?market={market}\n          'funding_payments', // leverage tokens\n          'lt/balances', 'lt/creations', 'lt/redemptions', // subaccounts\n          'subaccounts', 'subaccounts/{nickname}/balances', // otc\n          'otc/quotes/{quoteId}', // options\n          'options/my_requests', 'options/requests/{request_id}/quotes', 'options/my_quotes', 'options/account_info', 'options/positions', 'options/fills', // staking\n          'staking/stakes', 'staking/unstake_requests', 'staking/balances', 'staking/staking_rewards'],\n          'post': ['account/leverage', 'wallet/withdrawals', 'wallet/saved_addresses', 'orders', 'conditional_orders', 'orders/{order_id}/modify', 'orders/by_client_id/{client_order_id}/modify', 'conditional_orders/{order_id}/modify', // spot margin\n          'spot_margin/offers', // leverage tokens\n          'lt/{token_name}/create', 'lt/{token_name}/redeem', // subaccounts\n          'subaccounts', 'subaccounts/update_name', 'subaccounts/transfer', // otc\n          'otc/quotes/{quote_id}/accept', 'otc/quotes', // options\n          'options/requests', 'options/requests/{request_id}/quotes', 'options/quotes/{quote_id}/accept', // staking\n          'staking/unstake_requests', 'srm_stakes/stakes'],\n          'delete': ['wallet/saved_addresses/{saved_address_id}', 'orders/{order_id}', 'orders/by_client_id/{client_order_id}', 'orders', 'conditional_orders/{order_id}', // subaccounts\n          'subaccounts', // options\n          'options/requests/{request_id}', 'options/quotes/{quote_id}', // staking\n          'staking/unstake_requests/{request_id}']\n        }\n      },\n      'fees': {\n        'trading': {\n          'tierBased': true,\n          'percentage': true,\n          'maker': 0.02 / 100,\n          'taker': 0.07 / 100,\n          'tiers': {\n            'taker': [[0, 0.07 / 100], [1000000, 0.06 / 100], [5000000, 0.055 / 100], [10000000, 0.05 / 100], [15000000, 0.045 / 100], [35000000, 0.04 / 100]],\n            'maker': [[0, 0.02 / 100], [1000000, 0.02 / 100], [5000000, 0.015 / 100], [10000000, 0.015 / 100], [15000000, 0.01 / 100], [35000000, 0.01 / 100]]\n          }\n        },\n        'funding': {\n          'withdraw': {}\n        }\n      },\n      'exceptions': {\n        'exact': {\n          'Please slow down': RateLimitExceeded,\n          // {\"error\":\"Please slow down\",\"success\":false}\n          'Size too small for provide': InvalidOrder,\n          // {\"error\":\"Size too small for provide\",\"success\":false}\n          'Not logged in': AuthenticationError,\n          // {\"error\":\"Not logged in\",\"success\":false}\n          'Not enough balances': InsufficientFunds,\n          // {\"error\":\"Not enough balances\",\"success\":false}\n          'InvalidPrice': InvalidOrder,\n          // {\"error\":\"Invalid price\",\"success\":false}\n          'Size too small': InvalidOrder,\n          // {\"error\":\"Size too small\",\"success\":false}\n          'Size too large': InvalidOrder,\n          // {\"error\":\"Size too large\",\"success\":false}\n          'Missing parameter price': InvalidOrder,\n          // {\"error\":\"Missing parameter price\",\"success\":false}\n          'Order not found': OrderNotFound,\n          // {\"error\":\"Order not found\",\"success\":false}\n          'Order already closed': InvalidOrder,\n          // {\"error\":\"Order already closed\",\"success\":false}\n          'Trigger price too high': InvalidOrder,\n          // {\"error\":\"Trigger price too high\",\"success\":false}\n          'Trigger price too low': InvalidOrder,\n          // {\"error\":\"Trigger price too low\",\"success\":false}\n          'Order already queued for cancellation': CancelPending,\n          // {\"error\":\"Order already queued for cancellation\",\"success\":false}\n          'Duplicate client order ID': DuplicateOrderId,\n          // {\"error\":\"Duplicate client order ID\",\"success\":false}\n          'Spot orders cannot be reduce-only': InvalidOrder,\n          // {\"error\":\"Spot orders cannot be reduce-only\",\"success\":false}\n          'Invalid reduce-only order': InvalidOrder // {\"error\":\"Invalid reduce-only order\",\"success\":false}\n\n        },\n        'broad': {\n          'Account does not have enough margin for order': InsufficientFunds,\n          'Invalid parameter': BadRequest,\n          // {\"error\":\"Invalid parameter start_time\",\"success\":false}\n          'The requested URL was not found on the server': BadRequest,\n          'No such coin': BadRequest,\n          'No such market': BadSymbol,\n          'Do not send more than': RateLimitExceeded,\n          'An unexpected error occurred': ExchangeNotAvailable,\n          // {\"error\":\"An unexpected error occurred, please try again later (58BC21C795).\",\"success\":false}\n          'Please retry request': ExchangeNotAvailable,\n          // {\"error\":\"Please retry request\",\"success\":false}\n          'Please try again': ExchangeNotAvailable,\n          // {\"error\":\"Please try again\",\"success\":false}\n          'Try again': ExchangeNotAvailable,\n          // {\"error\":\"Try again\",\"success\":false}\n          'Only have permissions for subaccount': PermissionDenied // {\"success\":false,\"error\":\"Only have permissions for subaccount *sub_name*\"}\n\n        }\n      },\n      'precisionMode': TICK_SIZE,\n      'options': {\n        // support for canceling conditional orders\n        // https://github.com/ccxt/ccxt/issues/6669\n        'cancelOrder': {\n          'method': 'privateDeleteOrdersOrderId' // privateDeleteConditionalOrdersOrderId\n\n        },\n        'fetchOpenOrders': {\n          'method': 'privateGetOrders' // privateGetConditionalOrders\n\n        },\n        'fetchOrders': {\n          'method': 'privateGetOrdersHistory' // privateGetConditionalOrdersHistory\n\n        },\n        'sign': {\n          'ftx.com': 'FTX',\n          'ftx.us': 'FTXUS'\n        }\n      }\n    });\n  }\n\n  async fetchCurrencies(params = {}) {\n    const response = await this.publicGetCoins(params);\n    const currencies = this.safeValue(response, 'result', []); //\n    //     {\n    //         \"success\":true,\n    //         \"result\": [\n    //             {\"id\":\"BTC\",\"name\":\"Bitcoin\"},\n    //             {\"id\":\"ETH\",\"name\":\"Ethereum\"},\n    //             {\"id\":\"ETHMOON\",\"name\":\"10X Long Ethereum Token\",\"underlying\":\"ETH\"},\n    //             {\"id\":\"EOSBULL\",\"name\":\"3X Long EOS Token\",\"underlying\":\"EOS\"},\n    //         ],\n    //     }\n    //\n\n    const result = {};\n\n    for (let i = 0; i < currencies.length; i++) {\n      const currency = currencies[i];\n      const id = this.safeString(currency, 'id');\n      const code = this.safeCurrencyCode(id);\n      const name = this.safeString(currency, 'name');\n      result[code] = {\n        'id': id,\n        'code': code,\n        'info': currency,\n        'type': undefined,\n        'name': name,\n        'active': undefined,\n        'fee': undefined,\n        'precision': undefined,\n        'limits': {\n          'withdraw': {\n            'min': undefined,\n            'max': undefined\n          },\n          'amount': {\n            'min': undefined,\n            'max': undefined\n          }\n        }\n      };\n    }\n\n    return result;\n  }\n\n  async fetchMarkets(params = {}) {\n    const response = await this.publicGetMarkets(params); //\n    //     {\n    //         'success': true,\n    //         \"result\": [\n    //             {\n    //                 \"ask\":170.37,\n    //                 \"baseCurrency\":null,\n    //                 \"bid\":170.31,\n    //                 \"change1h\":-0.019001554672655036,\n    //                 \"change24h\":-0.024841165359738997,\n    //                 \"changeBod\":-0.03816406029469881,\n    //                 \"enabled\":true,\n    //                 \"last\":170.37,\n    //                 \"name\":\"ETH-PERP\",\n    //                 \"price\":170.37,\n    //                 \"priceIncrement\":0.01,\n    //                 \"quoteCurrency\":null,\n    //                 \"quoteVolume24h\":7742164.59889,\n    //                 \"sizeIncrement\":0.001,\n    //                 \"type\":\"future\",\n    //                 \"underlying\":\"ETH\",\n    //                 \"volumeUsd24h\":7742164.59889\n    //             },\n    //             {\n    //                 \"ask\":170.44,\n    //                 \"baseCurrency\":\"ETH\",\n    //                 \"bid\":170.41,\n    //                 \"change1h\":-0.018485459257126403,\n    //                 \"change24h\":-0.023825887743413515,\n    //                 \"changeBod\":-0.037605872388481086,\n    //                 \"enabled\":true,\n    //                 \"last\":172.72,\n    //                 \"name\":\"ETH/USD\",\n    //                 \"price\":170.44,\n    //                 \"priceIncrement\":0.01,\n    //                 \"quoteCurrency\":\"USD\",\n    //                 \"quoteVolume24h\":382802.0252,\n    //                 \"sizeIncrement\":0.001,\n    //                 \"type\":\"spot\",\n    //                 \"underlying\":null,\n    //                 \"volumeUsd24h\":382802.0252\n    //             },\n    //         ],\n    //     }\n    //\n\n    const result = [];\n    const markets = this.safeValue(response, 'result', []);\n\n    for (let i = 0; i < markets.length; i++) {\n      const market = markets[i];\n      const id = this.safeString(market, 'name');\n      const baseId = this.safeString2(market, 'baseCurrency', 'underlying');\n      const quoteId = this.safeString(market, 'quoteCurrency', 'USD');\n      const type = this.safeString(market, 'type');\n      const base = this.safeCurrencyCode(baseId);\n      const quote = this.safeCurrencyCode(quoteId); // check if a market is a spot or future market\n\n      const symbol = type === 'future' ? this.safeString(market, 'name') : base + '/' + quote;\n      const active = this.safeValue(market, 'enabled');\n      const sizeIncrement = this.safeNumber(market, 'sizeIncrement');\n      const priceIncrement = this.safeNumber(market, 'priceIncrement');\n      const precision = {\n        'amount': sizeIncrement,\n        'price': priceIncrement\n      };\n      result.push({\n        'id': id,\n        'symbol': symbol,\n        'base': base,\n        'quote': quote,\n        'baseId': baseId,\n        'quoteId': quoteId,\n        'type': type,\n        'future': type === 'future',\n        'spot': type === 'spot',\n        'active': active,\n        'precision': precision,\n        'limits': {\n          'amount': {\n            'min': sizeIncrement,\n            'max': undefined\n          },\n          'price': {\n            'min': priceIncrement,\n            'max': undefined\n          },\n          'cost': {\n            'min': undefined,\n            'max': undefined\n          }\n        },\n        'info': market\n      });\n    }\n\n    return result;\n  }\n\n  parseTicker(ticker, market = undefined) {\n    //\n    //     {\n    //         \"ask\":171.29,\n    //         \"baseCurrency\":null, // base currency for spot markets\n    //         \"bid\":171.24,\n    //         \"change1h\":-0.0012244897959183673,\n    //         \"change24h\":-0.031603346901854366,\n    //         \"changeBod\":-0.03297013492914808,\n    //         \"enabled\":true,\n    //         \"last\":171.44,\n    //         \"name\":\"ETH-PERP\",\n    //         \"price\":171.29,\n    //         \"priceIncrement\":0.01,\n    //         \"quoteCurrency\":null, // quote currency for spot markets\n    //         \"quoteVolume24h\":8570651.12113,\n    //         \"sizeIncrement\":0.001,\n    //         \"type\":\"future\",\n    //         \"underlying\":\"ETH\", // null for spot markets\n    //         \"volumeUsd24h\":8570651.12113,\n    //     }\n    //\n    let symbol = undefined;\n    const marketId = this.safeString(ticker, 'name');\n\n    if (marketId in this.markets_by_id) {\n      market = this.markets_by_id[marketId];\n    } else {\n      const type = this.safeString(ticker, 'type');\n\n      if (type === 'future') {\n        symbol = marketId;\n      } else {\n        const base = this.safeCurrencyCode(this.safeString(ticker, 'baseCurrency'));\n        const quote = this.safeCurrencyCode(this.safeString(ticker, 'quoteCurrency'));\n\n        if (base !== undefined && quote !== undefined) {\n          symbol = base + '/' + quote;\n        }\n      }\n    }\n\n    if (symbol === undefined && market !== undefined) {\n      symbol = market['symbol'];\n    }\n\n    const last = this.safeNumber(ticker, 'last');\n    const timestamp = this.safeTimestamp(ticker, 'time', this.milliseconds());\n    return {\n      'symbol': symbol,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'high': this.safeNumber(ticker, 'high'),\n      'low': this.safeNumber(ticker, 'low'),\n      'bid': this.safeNumber(ticker, 'bid'),\n      'bidVolume': this.safeNumber(ticker, 'bidSize'),\n      'ask': this.safeNumber(ticker, 'ask'),\n      'askVolume': this.safeNumber(ticker, 'askSize'),\n      'vwap': undefined,\n      'open': undefined,\n      'close': last,\n      'last': last,\n      'previousClose': undefined,\n      'change': undefined,\n      'percentage': this.safeNumber(ticker, 'change24h'),\n      'average': undefined,\n      'baseVolume': undefined,\n      'quoteVolume': this.safeNumber(ticker, 'quoteVolume24h'),\n      'info': ticker\n    };\n  }\n\n  async fetchTicker(symbol, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market_name': market['id']\n    };\n    const response = await this.publicGetMarketsMarketName(this.extend(request, params)); //\n    //     {\n    //         \"success\":true,\n    //         \"result\":{\n    //             \"ask\":171.29,\n    //             \"baseCurrency\":null, // base currency for spot markets\n    //             \"bid\":171.24,\n    //             \"change1h\":-0.0012244897959183673,\n    //             \"change24h\":-0.031603346901854366,\n    //             \"changeBod\":-0.03297013492914808,\n    //             \"enabled\":true,\n    //             \"last\":171.44,\n    //             \"name\":\"ETH-PERP\",\n    //             \"price\":171.29,\n    //             \"priceIncrement\":0.01,\n    //             \"quoteCurrency\":null, // quote currency for spot markets\n    //             \"quoteVolume24h\":8570651.12113,\n    //             \"sizeIncrement\":0.001,\n    //             \"type\":\"future\",\n    //             \"underlying\":\"ETH\", // null for spot markets\n    //             \"volumeUsd24h\":8570651.12113,\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return this.parseTicker(result, market);\n  }\n\n  async fetchTickers(symbols = undefined, params = {}) {\n    await this.loadMarkets();\n    const response = await this.publicGetMarkets(params); //\n    //     {\n    //         'success': true,\n    //         \"result\": [\n    //             {\n    //                 \"ask\":170.44,\n    //                 \"baseCurrency\":\"ETH\",\n    //                 \"bid\":170.41,\n    //                 \"change1h\":-0.018485459257126403,\n    //                 \"change24h\":-0.023825887743413515,\n    //                 \"changeBod\":-0.037605872388481086,\n    //                 \"enabled\":true,\n    //                 \"last\":172.72,\n    //                 \"name\":\"ETH/USD\",\n    //                 \"price\":170.44,\n    //                 \"priceIncrement\":0.01,\n    //                 \"quoteCurrency\":\"USD\",\n    //                 \"quoteVolume24h\":382802.0252,\n    //                 \"sizeIncrement\":0.001,\n    //                 \"type\":\"spot\",\n    //                 \"underlying\":null,\n    //                 \"volumeUsd24h\":382802.0252\n    //             },\n    //         ],\n    //     }\n    //\n\n    const tickers = this.safeValue(response, 'result', []);\n    return this.parseTickers(tickers, symbols);\n  }\n\n  async fetchOrderBook(symbol, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market_name': market['id']\n    };\n\n    if (limit !== undefined) {\n      request['depth'] = limit; // max 100, default 20\n    }\n\n    const response = await this.publicGetMarketsMarketNameOrderbook(this.extend(request, params)); //\n    //     {\n    //         \"success\":true,\n    //         \"result\":{\n    //             \"asks\":[\n    //                 [171.95,279.865],\n    //                 [171.98,102.42],\n    //                 [171.99,124.11],\n    //             ],\n    //             \"bids\":[\n    //                 [171.93,69.749],\n    //                 [171.9,288.325],\n    //                 [171.88,87.47],\n    //             ],\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return this.parseOrderBook(result, symbol);\n  }\n\n  parseOHLCV(ohlcv, market = undefined) {\n    //\n    //     {\n    //         \"close\":177.23,\n    //         \"high\":177.45,\n    //         \"low\":177.2,\n    //         \"open\":177.43,\n    //         \"startTime\":\"2019-10-17T13:27:00+00:00\",\n    //         \"time\":1571318820000.0,\n    //         \"volume\":0.0\n    //     }\n    //\n    return [this.safeInteger(ohlcv, 'time'), this.safeNumber(ohlcv, 'open'), this.safeNumber(ohlcv, 'high'), this.safeNumber(ohlcv, 'low'), this.safeNumber(ohlcv, 'close'), this.safeNumber(ohlcv, 'volume')];\n  }\n\n  getMarketId(symbol, key, params = {}) {\n    const parts = this.getMarketParams(symbol, key, params);\n    return this.safeString(parts, 1, symbol);\n  }\n\n  getMarketParams(symbol, key, params = {}) {\n    let market = undefined;\n    let marketId = undefined;\n\n    if (symbol in this.markets) {\n      market = this.market(symbol);\n      marketId = market['id'];\n    } else {\n      marketId = this.safeString(params, key, symbol);\n    }\n\n    return [market, marketId];\n  }\n\n  async fetchOHLCV(symbol, timeframe = '1m', since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const [market, marketId] = this.getMarketParams(symbol, 'market_name', params);\n    const request = {\n      'resolution': this.timeframes[timeframe],\n      'market_name': marketId\n    }; // max 1501 candles, including the current candle when since is not specified\n\n    limit = limit === undefined ? 1501 : limit;\n\n    if (since === undefined) {\n      request['end_time'] = this.seconds();\n      request['limit'] = limit;\n      request['start_time'] = request['end_time'] - limit * this.parseTimeframe(timeframe);\n    } else {\n      request['start_time'] = parseInt(since / 1000);\n      request['limit'] = limit;\n      request['end_time'] = this.sum(request['start_time'], limit * this.parseTimeframe(timeframe));\n    }\n\n    const response = await this.publicGetMarketsMarketNameCandles(this.extend(request, params)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\":[\n    //             {\n    //                 \"close\":177.23,\n    //                 \"high\":177.45,\n    //                 \"low\":177.2,\n    //                 \"open\":177.43,\n    //                 \"startTime\":\"2019-10-17T13:27:00+00:00\",\n    //                 \"time\":1571318820000.0,\n    //                 \"volume\":0.0\n    //             },\n    //             {\n    //                 \"close\":177.26,\n    //                 \"high\":177.33,\n    //                 \"low\":177.23,\n    //                 \"open\":177.23,\n    //                 \"startTime\":\"2019-10-17T13:28:00+00:00\",\n    //                 \"time\":1571318880000.0,\n    //                 \"volume\":0.0\n    //             },\n    //         ],\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    return this.parseOHLCVs(result, market, timeframe, since, limit);\n  }\n\n  parseTrade(trade, market = undefined) {\n    //\n    // fetchTrades (public)\n    //\n    //     {\n    //         \"id\":1715826,\n    //         \"liquidation\":false,\n    //         \"price\":171.62,\n    //         \"side\":\"buy\",\n    //         \"size\":2.095,\n    //         \"time\":\"2019-10-18T12:59:54.288166+00:00\"\n    //     }\n    //\n    // fetchMyTrades (private)\n    //\n    //     {\n    //         \"fee\": 20.1374935,\n    //         \"feeRate\": 0.0005,\n    //         \"feeCurrency\": \"USD\",\n    //         \"future\": \"EOS-0329\",\n    //         \"id\": 11215,\n    //         \"liquidity\": \"taker\",\n    //         \"market\": \"EOS-0329\",\n    //         \"baseCurrency\": null,\n    //         \"quoteCurrency\": null,\n    //         \"orderId\": 8436981,\n    //         \"price\": 4.201,\n    //         \"side\": \"buy\",\n    //         \"size\": 9587,\n    //         \"time\": \"2019-03-27T19:15:10.204619+00:00\",\n    //         \"type\": \"order\"\n    //     }\n    //\n    //     {\n    //         \"baseCurrency\": \"BTC\",\n    //         \"fee\": 0,\n    //         \"feeCurrency\": \"USD\",\n    //         \"feeRate\": 0,\n    //         \"future\": null,\n    //         \"id\": 664079556,\n    //         \"liquidity\": \"taker\",\n    //         \"market\": null,\n    //         \"orderId\": null,\n    //         \"price\": 34830.61359,\n    //         \"quoteCurrency\": \"USD\",\n    //         \"side\": \"sell\",\n    //         \"size\": 0.0005996,\n    //         \"time\": \"2021-01-15T16:05:29.246135+00:00\",\n    //         \"tradeId\": null,\n    //         \"type\": \"otc\"\n    //     }\n    //\n    //     with -ve fee\n    //     {\n    //         \"id\": 1171258927,\n    //         \"fee\": -0.0000713875,\n    //         \"side\": \"sell\",\n    //         \"size\": 1,\n    //         \"time\": \"2021-03-11T13:34:35.523627+00:00\",\n    //         \"type\": \"order\",\n    //         \"price\": 14.2775,\n    //         \"future\": null,\n    //         \"market\": \"SOL/USD\",\n    //         \"feeRate\": -0.000005,\n    //         \"orderId\": 33182929044,\n    //         \"tradeId\": 582936801,\n    //         \"liquidity\": \"maker\",\n    //         \"feeCurrency\": \"USD\",\n    //         \"baseCurrency\": \"SOL\",\n    //         \"quoteCurrency\": \"USD\"\n    //     }\n    //\n    //     // from OTC order\n    //     {\n    //         \"id\": 1172129651,\n    //         \"fee\": 0,\n    //         \"side\": \"sell\",\n    //         \"size\": 1.47568846,\n    //         \"time\": \"2021-03-11T15:04:46.893383+00:00\",\n    //         \"type\": \"otc\",\n    //         \"price\": 14.60932598,\n    //         \"future\": null,\n    //         \"market\": null,\n    //         \"feeRate\": 0,\n    //         \"orderId\": null,\n    //         \"tradeId\": null,\n    //         \"liquidity\": \"taker\",\n    //         \"feeCurrency\": \"USD\",\n    //         \"baseCurrency\": \"BCHA\",\n    //         \"quoteCurrency\": \"USD\"\n    //     }\n    const id = this.safeString(trade, 'id');\n    const takerOrMaker = this.safeString(trade, 'liquidity');\n    const marketId = this.safeString(trade, 'market');\n    let symbol = undefined;\n\n    if (marketId in this.markets_by_id) {\n      market = this.markets_by_id[marketId];\n      symbol = market['symbol'];\n    } else {\n      const base = this.safeCurrencyCode(this.safeString(trade, 'baseCurrency'));\n      const quote = this.safeCurrencyCode(this.safeString(trade, 'quoteCurrency'));\n\n      if (base !== undefined && quote !== undefined) {\n        symbol = base + '/' + quote;\n      } else {\n        symbol = marketId;\n      }\n    }\n\n    const timestamp = this.parse8601(this.safeString(trade, 'time'));\n    const priceString = this.safeString(trade, 'price');\n    const amountString = this.safeString(trade, 'size');\n    const price = this.parseNumber(priceString);\n    const amount = this.parseNumber(amountString);\n    const cost = this.parseNumber(Precise.stringMul(priceString, amountString));\n\n    if (symbol === undefined && market !== undefined) {\n      symbol = market['symbol'];\n    }\n\n    const side = this.safeString(trade, 'side');\n    let fee = undefined;\n    const feeCost = this.safeNumber(trade, 'fee');\n\n    if (feeCost !== undefined) {\n      const feeCurrencyId = this.safeString(trade, 'feeCurrency');\n      const feeCurrencyCode = this.safeCurrencyCode(feeCurrencyId);\n      fee = {\n        'cost': feeCost,\n        'currency': feeCurrencyCode,\n        'rate': this.safeNumber(trade, 'feeRate')\n      };\n    }\n\n    const orderId = this.safeString(trade, 'orderId');\n    return {\n      'info': trade,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'symbol': symbol,\n      'id': id,\n      'order': orderId,\n      'type': undefined,\n      'takerOrMaker': takerOrMaker,\n      'side': side,\n      'price': price,\n      'amount': amount,\n      'cost': cost,\n      'fee': fee\n    };\n  }\n\n  async fetchTrades(symbol, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const [market, marketId] = this.getMarketParams(symbol, 'market_name', params);\n    const request = {\n      'market_name': marketId\n    };\n\n    if (since !== undefined) {\n      request['start_time'] = parseInt(since / 1000); // start_time doesn't work without end_time\n\n      request['end_time'] = this.seconds();\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    }\n\n    const response = await this.publicGetMarketsMarketNameTrades(this.extend(request, params)); //\n    //     {\n    //         \"success\":true,\n    //         \"result\":[\n    //             {\n    //                 \"id\":1715826,\n    //                 \"liquidation\":false,\n    //                 \"price\":171.62,\n    //                 \"side\":\"buy\",\n    //                 \"size\":2.095,\n    //                 \"time\":\"2019-10-18T12:59:54.288166+00:00\"\n    //             },\n    //             {\n    //                 \"id\":1715763,\n    //                 \"liquidation\":false,\n    //                 \"price\":171.89,\n    //                 \"side\":\"sell\",\n    //                 \"size\":1.477,\n    //                 \"time\":\"2019-10-18T12:58:38.443734+00:00\"\n    //             },\n    //         ],\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    return this.parseTrades(result, market, since, limit);\n  }\n\n  async fetchTradingFees(params = {}) {\n    await this.loadMarkets();\n    const response = await this.privateGetAccount(params); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"backstopProvider\": true,\n    //             \"collateral\": 3568181.02691129,\n    //             \"freeCollateral\": 1786071.456884368,\n    //             \"initialMarginRequirement\": 0.12222384240257728,\n    //             \"liquidating\": false,\n    //             \"maintenanceMarginRequirement\": 0.07177992558058484,\n    //             \"makerFee\": 0.0002,\n    //             \"marginFraction\": 0.5588433331419503,\n    //             \"openMarginFraction\": 0.2447194090423075,\n    //             \"takerFee\": 0.0005,\n    //             \"totalAccountValue\": 3568180.98341129,\n    //             \"totalPositionSize\": 6384939.6992,\n    //             \"username\": \"user@domain.com\",\n    //             \"positions\": [\n    //                 {\n    //                     \"cost\": -31.7906,\n    //                     \"entryPrice\": 138.22,\n    //                     \"future\": \"ETH-PERP\",\n    //                     \"initialMarginRequirement\": 0.1,\n    //                     \"longOrderSize\": 1744.55,\n    //                     \"maintenanceMarginRequirement\": 0.04,\n    //                     \"netSize\": -0.23,\n    //                     \"openSize\": 1744.32,\n    //                     \"realizedPnl\": 3.39441714,\n    //                     \"shortOrderSize\": 1732.09,\n    //                     \"side\": \"sell\",\n    //                     \"size\": 0.23,\n    //                     \"unrealizedPnl\": 0,\n    //                 },\n    //             ],\n    //         },\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return {\n      'info': response,\n      'maker': this.safeNumber(result, 'makerFee'),\n      'taker': this.safeNumber(result, 'takerFee')\n    };\n  }\n\n  async fetchBalance(params = {}) {\n    await this.loadMarkets();\n    const response = await this.privateGetWalletBalances(params); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"coin\": \"USDTBEAR\",\n    //                 \"free\": 2320.2,\n    //                 \"total\": 2340.2\n    //             },\n    //         ],\n    //     }\n    //\n\n    const result = {\n      'info': response\n    };\n    const balances = this.safeValue(response, 'result', []);\n\n    for (let i = 0; i < balances.length; i++) {\n      const balance = balances[i];\n      const code = this.safeCurrencyCode(this.safeString(balance, 'coin'));\n      const account = this.account();\n      account['free'] = this.safeString(balance, 'free');\n      account['total'] = this.safeString(balance, 'total');\n      result[code] = account;\n    }\n\n    return this.parseBalance(result, false);\n  }\n\n  parseOrderStatus(status) {\n    const statuses = {\n      'new': 'open',\n      'open': 'open',\n      'closed': 'closed',\n      // filled or canceled\n      'triggered': 'closed'\n    };\n    return this.safeString(statuses, status, status);\n  }\n\n  parseOrder(order, market = undefined) {\n    //\n    // limit orders - fetchOrder, fetchOrders, fetchOpenOrders, createOrder, editOrder\n    //\n    //     {\n    //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"filledSize\": 0,\n    //         \"future\": \"XRP-PERP\",\n    //         \"id\": 9596912,\n    //         \"market\": \"XRP-PERP\",\n    //         \"price\": 0.306525,\n    //         \"remainingSize\": 31431,\n    //         \"side\": \"sell\",\n    //         \"size\": 31431,\n    //         \"status\": \"open\",\n    //         \"type\": \"limit\",\n    //         \"reduceOnly\": false,\n    //         \"ioc\": false,\n    //         \"postOnly\": false,\n    //         \"clientId\": null,\n    //     }\n    //\n    // market orders - fetchOrder, fetchOrders, fetchOpenOrders, createOrder\n    //\n    //     {\n    //         \"avgFillPrice\": 2666.0,\n    //         \"clientId\": None,\n    //         \"createdAt\": \"2020-02-12T00: 53: 49.009726+00: 00\",\n    //         \"filledSize\": 0.0007,\n    //         \"future\": None,\n    //         \"id\": 3109208514,\n    //         \"ioc\": True,\n    //         \"market\": \"BNBBULL/USD\",\n    //         \"postOnly\": False,\n    //         \"price\": None,\n    //         \"reduceOnly\": False,\n    //         \"remainingSize\": 0.0,\n    //         \"side\": \"buy\",\n    //         \"size\": 0.0007,\n    //         \"status\": \"closed\",\n    //         \"type\": \"market\"\n    //     }\n    //\n    // createOrder (conditional, \"stop\", \"trailingStop\", or \"takeProfit\")\n    //\n    //     {\n    //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"future\": \"XRP-PERP\",\n    //         \"id\": 9596912,\n    //         \"market\": \"XRP-PERP\",\n    //         \"triggerPrice\": 0.306525,\n    //         \"orderId\": null,\n    //         \"side\": \"sell\",\n    //         \"size\": 31431,\n    //         \"status\": \"open\",\n    //         \"type\": \"stop\",\n    //         \"orderPrice\": null,\n    //         \"error\": null,\n    //         \"triggeredAt\": null,\n    //         \"reduceOnly\": false\n    //     }\n    //\n    // editOrder (conditional, stop, trailing stop, take profit)\n    //\n    //     {\n    //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"future\": \"XRP-PERP\",\n    //         \"id\": 9596912,\n    //         \"market\": \"XRP-PERP\",\n    //         \"triggerPrice\": 0.306225,\n    //         \"orderId\": null,\n    //         \"side\": \"sell\",\n    //         \"size\": 31431,\n    //         \"status\": \"open\",\n    //         \"type\": \"stop\",\n    //         \"orderPrice\": null,\n    //         \"error\": null,\n    //         \"triggeredAt\": null,\n    //         \"reduceOnly\": false,\n    //         \"orderType\": \"market\",\n    //         \"filledSize\": 0,\n    //         \"avgFillPrice\": null,\n    //         \"retryUntilFilled\": false\n    //     }\n    //\n    // canceled order with a closed status\n    //\n    //     {\n    //         \"avgFillPrice\":null,\n    //         \"clientId\":null,\n    //         \"createdAt\":\"2020-09-01T13:45:57.119695+00:00\",\n    //         \"filledSize\":0.0,\n    //         \"future\":null,\n    //         \"id\":8553541288,\n    //         \"ioc\":false,\n    //         \"liquidation\":false,\n    //         \"market\":\"XRP/USDT\",\n    //         \"postOnly\":false,\n    //         \"price\":0.5,\n    //         \"reduceOnly\":false,\n    //         \"remainingSize\":0.0,\n    //         \"side\":\"sell\",\n    //         \"size\":46.0,\n    //         \"status\":\"closed\",\n    //         \"type\":\"limit\"\n    //     }\n    //\n    const id = this.safeString(order, 'id');\n    const timestamp = this.parse8601(this.safeString(order, 'createdAt'));\n    let status = this.parseOrderStatus(this.safeString(order, 'status'));\n    const amount = this.safeNumber(order, 'size');\n    const filled = this.safeNumber(order, 'filledSize');\n    let remaining = this.safeNumber(order, 'remainingSize');\n\n    if (remaining === 0.0 && amount !== undefined && filled !== undefined) {\n      remaining = Math.max(amount - filled, 0);\n\n      if (remaining > 0) {\n        status = 'canceled';\n      }\n    }\n\n    let symbol = undefined;\n    const marketId = this.safeString(order, 'market');\n\n    if (marketId !== undefined) {\n      if (marketId in this.markets_by_id) {\n        market = this.markets_by_id[marketId];\n        symbol = market['symbol'];\n      } else {\n        // support for delisted market ids\n        // https://github.com/ccxt/ccxt/issues/7113\n        symbol = marketId;\n      }\n    }\n\n    if (symbol === undefined && market !== undefined) {\n      symbol = market['symbol'];\n    }\n\n    const side = this.safeString(order, 'side');\n    const type = this.safeString(order, 'type');\n    const average = this.safeNumber(order, 'avgFillPrice');\n    const price = this.safeNumber2(order, 'price', 'triggerPrice', average);\n    let cost = undefined;\n\n    if (filled !== undefined && price !== undefined) {\n      cost = filled * price;\n    }\n\n    const lastTradeTimestamp = this.parse8601(this.safeString(order, 'triggeredAt'));\n    const clientOrderId = this.safeString(order, 'clientId');\n    const stopPrice = this.safeNumber(order, 'triggerPrice');\n    const postOnly = this.safeValue(order, 'postOnly');\n    return {\n      'info': order,\n      'id': id,\n      'clientOrderId': clientOrderId,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'lastTradeTimestamp': lastTradeTimestamp,\n      'symbol': symbol,\n      'type': type,\n      'timeInForce': undefined,\n      'postOnly': postOnly,\n      'side': side,\n      'price': price,\n      'stopPrice': stopPrice,\n      'amount': amount,\n      'cost': cost,\n      'average': average,\n      'filled': filled,\n      'remaining': remaining,\n      'status': status,\n      'fee': undefined,\n      'trades': undefined\n    };\n  }\n\n  async createOrder(symbol, type, side, amount, price = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market': market['id'],\n      'side': side,\n      // \"buy\" or \"sell\"\n      // 'price': 0.306525, // send null for market orders\n      'type': type,\n      // \"limit\", \"market\", \"stop\", \"trailingStop\", or \"takeProfit\"\n      'size': parseFloat(this.amountToPrecision(symbol, amount)) // 'reduceOnly': false, // optional, default is false\n      // 'ioc': false, // optional, default is false, limit or market orders only\n      // 'postOnly': false, // optional, default is false, limit or market orders only\n      // 'clientId': 'abcdef0123456789', // string, optional, client order id, limit or market orders only\n\n    };\n    const clientOrderId = this.safeString2(params, 'clientId', 'clientOrderId');\n\n    if (clientOrderId !== undefined) {\n      request['clientId'] = clientOrderId;\n      params = this.omit(params, ['clientId', 'clientOrderId']);\n    }\n\n    let method = undefined;\n\n    if (type === 'limit') {\n      method = 'privatePostOrders';\n      request['price'] = parseFloat(this.priceToPrecision(symbol, price));\n    } else if (type === 'market') {\n      method = 'privatePostOrders';\n      request['price'] = null;\n    } else if (type === 'stop' || type === 'takeProfit') {\n      method = 'privatePostConditionalOrders';\n      const stopPrice = this.safeNumber2(params, 'stopPrice', 'triggerPrice');\n\n      if (stopPrice === undefined) {\n        throw new ArgumentsRequired(this.id + ' createOrder () requires a stopPrice parameter or a triggerPrice parameter for ' + type + ' orders');\n      } else {\n        params = this.omit(params, ['stopPrice', 'triggerPrice']);\n        request['triggerPrice'] = parseFloat(this.priceToPrecision(symbol, stopPrice));\n      }\n\n      if (price !== undefined) {\n        request['orderPrice'] = parseFloat(this.priceToPrecision(symbol, price)); // optional, order type is limit if this is specified, otherwise market\n      }\n    } else if (type === 'trailingStop') {\n      method = 'privatePostConditionalOrders';\n      request['trailValue'] = parseFloat(this.priceToPrecision(symbol, price)); // negative for \"sell\", positive for \"buy\"\n    } else {\n      throw new InvalidOrder(this.id + ' createOrder () does not support order type ' + type + ', only limit, market, stop, trailingStop, or takeProfit orders are supported');\n    }\n\n    const response = await this[method](this.extend(request, params)); //\n    // orders\n    //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //                 \"filledSize\": 0,\n    //                 \"future\": \"XRP-PERP\",\n    //                 \"id\": 9596912,\n    //                 \"market\": \"XRP-PERP\",\n    //                 \"price\": 0.306525,\n    //                 \"remainingSize\": 31431,\n    //                 \"side\": \"sell\",\n    //                 \"size\": 31431,\n    //                 \"status\": \"open\",\n    //                 \"type\": \"limit\",\n    //                 \"reduceOnly\": false,\n    //                 \"ioc\": false,\n    //                 \"postOnly\": false,\n    //                 \"clientId\": null,\n    //             }\n    //         ]\n    //     }\n    //\n    // conditional orders\n    //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //                 \"future\": \"XRP-PERP\",\n    //                 \"id\": 9596912,\n    //                 \"market\": \"XRP-PERP\",\n    //                 \"triggerPrice\": 0.306525,\n    //                 \"orderId\": null,\n    //                 \"side\": \"sell\",\n    //                 \"size\": 31431,\n    //                 \"status\": \"open\",\n    //                 \"type\": \"stop\",\n    //                 \"orderPrice\": null,\n    //                 \"error\": null,\n    //                 \"triggeredAt\": null,\n    //                 \"reduceOnly\": false\n    //             }\n    //         ]\n    //     }\n    //\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    return this.parseOrder(result, market);\n  }\n\n  async editOrder(id, symbol, type, side, amount, price = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {};\n    let method = undefined;\n    const clientOrderId = this.safeString2(params, 'client_order_id', 'clientOrderId');\n    const triggerPrice = this.safeNumber(params, 'triggerPrice');\n    const orderPrice = this.safeNumber(params, 'orderPrice');\n    const trailValue = this.safeNumber(params, 'trailValue');\n    params = this.omit(params, ['client_order_id', 'clientOrderId', 'triggerPrice', 'orderPrice', 'trailValue']);\n    const triggerPriceIsDefined = triggerPrice !== undefined;\n    const orderPriceIsDefined = orderPrice !== undefined;\n    const trailValueIsDefined = trailValue !== undefined;\n\n    if (triggerPriceIsDefined || orderPriceIsDefined || trailValueIsDefined) {\n      method = 'privatePostConditionalOrdersOrderIdModify';\n      request['order_id'] = id;\n\n      if (triggerPriceIsDefined) {\n        request['triggerPrice'] = parseFloat(this.priceToPrecision(symbol, triggerPrice));\n      }\n\n      if (orderPriceIsDefined) {\n        // only for stop limit or take profit limit orders\n        request['orderPrice'] = parseFloat(this.priceToPrecision(symbol, orderPrice));\n      }\n\n      if (trailValueIsDefined) {\n        // negative for sell orders, positive for buy orders\n        request['trailValue'] = parseFloat(this.priceToPrecision(symbol, trailValue));\n      }\n    } else {\n      if (clientOrderId === undefined) {\n        method = 'privatePostOrdersOrderIdModify';\n        request['order_id'] = id;\n      } else {\n        method = 'privatePostOrdersByClientIdClientOrderIdModify';\n        request['client_order_id'] = clientOrderId; // request['clientId'] = clientOrderId;\n      }\n\n      if (price !== undefined) {\n        request['price'] = parseFloat(this.priceToPrecision(symbol, price));\n      }\n    }\n\n    if (amount !== undefined) {\n      request['size'] = parseFloat(this.amountToPrecision(symbol, amount));\n    }\n\n    const response = await this[method](this.extend(request, params)); //\n    // regular order\n    //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"createdAt\": \"2019-03-05T11:56:55.728933+00:00\",\n    //             \"filledSize\": 0,\n    //             \"future\": \"XRP-PERP\",\n    //             \"id\": 9596932,\n    //             \"market\": \"XRP-PERP\",\n    //             \"price\": 0.326525,\n    //             \"remainingSize\": 31431,\n    //             \"side\": \"sell\",\n    //             \"size\": 31431,\n    //             \"status\": \"open\",\n    //             \"type\": \"limit\",\n    //             \"reduceOnly\": false,\n    //             \"ioc\": false,\n    //             \"postOnly\": false,\n    //             \"clientId\": null,\n    //         }\n    //     }\n    //\n    // conditional trigger order\n    //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"future\": \"XRP-PERP\",\n    //             \"id\": 9596912,\n    //             \"market\": \"XRP-PERP\",\n    //             \"triggerPrice\": 0.306225,\n    //             \"orderId\": null,\n    //             \"side\": \"sell\",\n    //             \"size\": 31431,\n    //             \"status\": \"open\",\n    //             \"type\": \"stop\",\n    //             \"orderPrice\": null,\n    //             \"error\": null,\n    //             \"triggeredAt\": null,\n    //             \"reduceOnly\": false,\n    //             \"orderType\": \"market\",\n    //             \"filledSize\": 0,\n    //             \"avgFillPrice\": null,\n    //             \"retryUntilFilled\": false\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return this.parseOrder(result, market);\n  }\n\n  async cancelOrder(id, symbol = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {}; // support for canceling conditional orders\n    // https://github.com/ccxt/ccxt/issues/6669\n\n    const options = this.safeValue(this.options, 'cancelOrder', {});\n    const defaultMethod = this.safeString(options, 'method', 'privateDeleteOrdersOrderId');\n    let method = this.safeString(params, 'method', defaultMethod);\n    const type = this.safeValue(params, 'type');\n    const clientOrderId = this.safeValue2(params, 'client_order_id', 'clientOrderId');\n\n    if (clientOrderId === undefined) {\n      request['order_id'] = parseInt(id);\n\n      if (type === 'stop' || type === 'trailingStop' || type === 'takeProfit') {\n        method = 'privateDeleteConditionalOrdersOrderId';\n      }\n    } else {\n      request['client_order_id'] = clientOrderId;\n      method = 'privateDeleteOrdersByClientIdClientOrderId';\n    }\n\n    const query = this.omit(params, ['method', 'type', 'client_order_id', 'clientOrderId']);\n    const response = await this[method](this.extend(request, query)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": \"Order queued for cancelation\"\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return result;\n  }\n\n  async cancelAllOrders(symbol = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {// 'market': market['id'], // optional\n      // 'conditionalOrdersOnly': false, // cancel conditional orders only\n      // 'limitOrdersOnly': false, // cancel existing limit orders (non-conditional orders) only\n    };\n    const marketId = this.getMarketId(symbol, 'market', params);\n\n    if (marketId !== undefined) {\n      request['market'] = marketId;\n    }\n\n    const response = await this.privateDeleteOrders(this.extend(request, params));\n    const result = this.safeValue(response, 'result', {}); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": \"Orders queued for cancelation\"\n    //     }\n    //\n\n    return result;\n  }\n\n  async fetchOrder(id, symbol = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {};\n    const clientOrderId = this.safeValue2(params, 'client_order_id', 'clientOrderId');\n    let method = 'privateGetOrdersOrderId';\n\n    if (clientOrderId === undefined) {\n      request['order_id'] = id;\n    } else {\n      request['client_order_id'] = clientOrderId;\n      params = this.omit(params, ['client_order_id', 'clientOrderId']);\n      method = 'privateGetOrdersByClientIdClientOrderId';\n    }\n\n    const response = await this[method](this.extend(request, params)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"filledSize\": 10,\n    //             \"future\": \"XRP-PERP\",\n    //             \"id\": 9596912,\n    //             \"market\": \"XRP-PERP\",\n    //             \"price\": 0.306525,\n    //             \"avgFillPrice\": 0.306526,\n    //             \"remainingSize\": 31421,\n    //             \"side\": \"sell\",\n    //             \"size\": 31431,\n    //             \"status\": \"open\",\n    //             \"type\": \"limit\",\n    //             \"reduceOnly\": false,\n    //             \"ioc\": false,\n    //             \"postOnly\": false,\n    //             \"clientId\": null\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return this.parseOrder(result);\n  }\n\n  async fetchOpenOrders(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {};\n    const [market, marketId] = this.getMarketParams(symbol, 'market', params);\n\n    if (marketId !== undefined) {\n      request['market'] = marketId;\n    } // support for canceling conditional orders\n    // https://github.com/ccxt/ccxt/issues/6669\n\n\n    const options = this.safeValue(this.options, 'fetchOpenOrders', {});\n    const defaultMethod = this.safeString(options, 'method', 'privateGetOrders');\n    let method = this.safeString(params, 'method', defaultMethod);\n    const type = this.safeValue(params, 'type');\n\n    if (type === 'stop' || type === 'trailingStop' || type === 'takeProfit') {\n      method = 'privateGetConditionalOrders';\n    }\n\n    const query = this.omit(params, ['method', 'type']);\n    const response = await this[method](this.extend(request, query)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //                 \"filledSize\": 10,\n    //                 \"future\": \"XRP-PERP\",\n    //                 \"id\": 9596912,\n    //                 \"market\": \"XRP-PERP\",\n    //                 \"price\": 0.306525,\n    //                 \"avgFillPrice\": 0.306526,\n    //                 \"remainingSize\": 31421,\n    //                 \"side\": \"sell\",\n    //                 \"size\": 31431,\n    //                 \"status\": \"open\",\n    //                 \"type\": \"limit\",\n    //                 \"reduceOnly\": false,\n    //                 \"ioc\": false,\n    //                 \"postOnly\": false,\n    //                 \"clientId\": null\n    //             }\n    //         ]\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    return this.parseOrders(result, market, since, limit);\n  }\n\n  async fetchOrders(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {};\n    const [market, marketId] = this.getMarketParams(symbol, 'market', params);\n\n    if (marketId !== undefined) {\n      request['market'] = marketId;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit; // default 100, max 100\n    }\n\n    if (since !== undefined) {\n      request['start_time'] = parseInt(since / 1000);\n    } // support for canceling conditional orders\n    // https://github.com/ccxt/ccxt/issues/6669\n\n\n    const options = this.safeValue(this.options, 'fetchOrders', {});\n    const defaultMethod = this.safeString(options, 'method', 'privateGetOrdersHistory');\n    let method = this.safeString(params, 'method', defaultMethod);\n    const type = this.safeValue(params, 'type');\n\n    if (type === 'stop' || type === 'trailingStop' || type === 'takeProfit') {\n      method = 'privateGetConditionalOrdersHistory';\n    }\n\n    const query = this.omit(params, ['method', 'type']);\n    const response = await this[method](this.extend(request, query)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n    //                 \"filledSize\": 10,\n    //                 \"future\": \"XRP-PERP\",\n    //                 \"id\": 9596912,\n    //                 \"market\": \"XRP-PERP\",\n    //                 \"price\": 0.306525,\n    //                 \"avgFillPrice\": 0.306526,\n    //                 \"remainingSize\": 31421,\n    //                 \"side\": \"sell\",\n    //                 \"size\": 31431,\n    //                 \"status\": \"open\",\n    //                 \"type\": \"limit\",\n    //                 \"reduceOnly\": false,\n    //                 \"ioc\": false,\n    //                 \"postOnly\": false,\n    //                 \"clientId\": null\n    //             }\n    //         ]\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    return this.parseOrders(result, market, since, limit);\n  }\n\n  async fetchMyTrades(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const [market, marketId] = this.getMarketParams(symbol, 'market', params);\n    const request = {};\n\n    if (marketId !== undefined) {\n      request['market'] = marketId;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    }\n\n    if (since !== undefined) {\n      request['start_time'] = parseInt(since / 1000);\n      request['end_time'] = this.seconds();\n    }\n\n    const response = await this.privateGetFills(this.extend(request, params)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": [\n    //             {\n    //                 \"fee\": 20.1374935,\n    //                 \"feeRate\": 0.0005,\n    //                 \"future\": \"EOS-0329\",\n    //                 \"id\": 11215,\n    //                 \"liquidity\": \"taker\",\n    //                 \"market\": \"EOS-0329\",\n    //                 \"baseCurrency\": null,\n    //                 \"quoteCurrency\": null,\n    //                 \"orderId\": 8436981,\n    //                 \"price\": 4.201,\n    //                 \"side\": \"buy\",\n    //                 \"size\": 9587,\n    //                 \"time\": \"2019-03-27T19:15:10.204619+00:00\",\n    //                 \"type\": \"order\"\n    //             }\n    //         ]\n    //     }\n    //\n\n    const trades = this.safeValue(response, 'result', []);\n    return this.parseTrades(trades, market, since, limit);\n  }\n\n  async withdraw(code, amount, address, tag = undefined, params = {}) {\n    await this.loadMarkets();\n    this.checkAddress(address);\n    const currency = this.currency(code);\n    const request = {\n      'coin': currency['id'],\n      'size': amount,\n      'address': address // 'password': 'string', // optional withdrawal password if it is required for your account\n      // 'code': '192837', // optional 2fa code if it is required for your account\n\n    };\n\n    if (this.password !== undefined) {\n      request['password'] = this.password;\n    }\n\n    if (tag !== undefined) {\n      request['tag'] = tag;\n    }\n\n    const response = await this.privatePostWalletWithdrawals(this.extend(request, params)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"coin\": \"USDTBEAR\",\n    //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n    //             \"tag\": \"null\",\n    //             \"fee\": 0,\n    //             \"id\": 1,\n    //             \"size\": \"20.2\",\n    //             \"status\": \"requested\",\n    //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"txid\": \"null\"\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    return this.parseTransaction(result, currency);\n  }\n\n  async fetchPositions(symbols = undefined, params = {}) {\n    await this.loadMarkets();\n    const response = await this.privateGetAccount(params); //\n    //     {\n    //         \"result\":{\n    //             \"backstopProvider\":false,\n    //             \"chargeInterestOnNegativeUsd\":false,\n    //             \"collateral\":2830.2567913677476,\n    //             \"freeCollateral\":2829.670741867416,\n    //             \"initialMarginRequirement\":0.05,\n    //             \"leverage\":20.0,\n    //             \"liquidating\":false,\n    //             \"maintenanceMarginRequirement\":0.03,\n    //             \"makerFee\":0.0,\n    //             \"marginFraction\":null,\n    //             \"openMarginFraction\":null,\n    //             \"positionLimit\":null,\n    //             \"positionLimitUsed\":null,\n    //             \"positions\":[\n    //                 {\n    //                     \"collateralUsed\":0.0,\n    //                     \"cost\":0.0,\n    //                     \"entryPrice\":null,\n    //                     \"estimatedLiquidationPrice\":null,\n    //                     \"future\":\"XRP-PERP\",\n    //                     \"initialMarginRequirement\":0.05,\n    //                     \"longOrderSize\":0.0,\n    //                     \"maintenanceMarginRequirement\":0.03,\n    //                     \"netSize\":0.0,\n    //                     \"openSize\":0.0,\n    //                     \"realizedPnl\":0.016,\n    //                     \"shortOrderSize\":0.0,\n    //                     \"side\":\"buy\",\n    //                     \"size\":0.0,\n    //                     \"unrealizedPnl\":0.0,\n    //                 }\n    //             ],\n    //             \"spotLendingEnabled\":false,\n    //             \"spotMarginEnabled\":false,\n    //             \"takerFee\":0.0007,\n    //             \"totalAccountValue\":2830.2567913677476,\n    //             \"totalPositionSize\":0.0,\n    //             \"useFttCollateral\":true,\n    //             \"username\":\"igor.kroitor@gmail.com\"\n    //         },\n    //         \"success\":true\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {}); // todo unify parsePosition/parsePositions\n\n    return this.safeValue(result, 'positions', []);\n  }\n\n  async fetchDepositAddress(code, params = {}) {\n    await this.loadMarkets();\n    const currency = this.currency(code);\n    const request = {\n      'coin': currency['id']\n    };\n    const response = await this.privateGetWalletDepositAddressCoin(this.extend(request, params)); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n    //             \"tag\": \"null\"\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', {});\n    const address = this.safeString(result, 'address');\n    const tag = this.safeString(result, 'tag');\n    this.checkAddress(address);\n    return {\n      'currency': code,\n      'address': address,\n      'tag': tag,\n      'info': response\n    };\n  }\n\n  parseTransactionStatus(status) {\n    const statuses = {\n      // what are other statuses here?\n      'confirmed': 'ok',\n      // deposits\n      'complete': 'ok' // withdrawals\n\n    };\n    return this.safeString(statuses, status, status);\n  }\n\n  parseTransaction(transaction, currency = undefined) {\n    //\n    // fetchDeposits\n    //\n    //     airdrop\n    //\n    //     {\n    //         \"id\": 9147072,\n    //         \"coin\": \"SRM_LOCKED\",\n    //         \"size\": 3.12,\n    //         \"time\": \"2021-04-27T23:59:03.565983+00:00\",\n    //         \"notes\": \"SRM Airdrop for FTT holdings\",\n    //         \"status\": \"complete\"\n    //     }\n    //\n    //     regular deposits\n    //\n    //     {\n    //         \"coin\": \"TUSD\",\n    //         \"confirmations\": 64,\n    //         \"confirmedTime\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"fee\": 0,\n    //         \"id\": 1,\n    //         \"sentTime\": \"2019-03-05T09:56:55.735929+00:00\",\n    //         \"size\": \"99.0\",\n    //         \"status\": \"confirmed\",\n    //         \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n    //     }\n    //\n    // fetchWithdrawals\n    //\n    //     {\n    //         \"coin\": \"TUSD\",\n    //         \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n    //         \"tag\": \"null\",\n    //         \"fee\": 0,\n    //         \"id\": 1,\n    //         \"size\": \"99.0\",\n    //         \"status\": \"complete\",\n    //         \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n    //         \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n    //     }\n    //\n    //     {\n    //         \"coin\": 'BTC',\n    //         \"id\": 1969806,\n    //         \"notes\": 'Transfer to Dd6gi7m2Eg4zzBbPAxuwfEaHs6tYvyUX5hbPpsTcNPXo',\n    //         \"size\": 0.003,\n    //         \"status\": 'complete',\n    //         \"time\": '2021-02-03T20:28:54.918146+00:00'\n    //     }\n    //\n    const code = this.safeCurrencyCode(this.safeString(transaction, 'coin'));\n    const id = this.safeString(transaction, 'id');\n    const amount = this.safeNumber(transaction, 'size');\n    const status = this.parseTransactionStatus(this.safeString(transaction, 'status'));\n    const timestamp = this.parse8601(this.safeString(transaction, 'time'));\n    const txid = this.safeString(transaction, 'txid');\n    let tag = undefined;\n    let address = this.safeValue(transaction, 'address');\n\n    if (typeof address !== 'string') {\n      tag = this.safeString(address, 'tag');\n      address = this.safeString(address, 'address');\n    }\n\n    if (address === undefined) {\n      // parse address from internal transfer\n      const notes = this.safeString(transaction, 'notes');\n\n      if (notes !== undefined && notes.indexOf('Transfer to') >= 0) {\n        address = notes.slice(12);\n      }\n    }\n\n    const fee = this.safeNumber(transaction, 'fee');\n    return {\n      'info': transaction,\n      'id': id,\n      'txid': txid,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'addressFrom': undefined,\n      'address': address,\n      'addressTo': address,\n      'tagFrom': undefined,\n      'tag': tag,\n      'tagTo': tag,\n      'type': undefined,\n      'amount': amount,\n      'currency': code,\n      'status': status,\n      'updated': undefined,\n      'fee': {\n        'currency': code,\n        'cost': fee,\n        'rate': undefined\n      }\n    };\n  }\n\n  async fetchDeposits(code = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const response = await this.privateGetWalletDeposits(params); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"coin\": \"TUSD\",\n    //             \"confirmations\": 64,\n    //             \"confirmedTime\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"fee\": 0,\n    //             \"id\": 1,\n    //             \"sentTime\": \"2019-03-05T09:56:55.735929+00:00\",\n    //             \"size\": \"99.0\",\n    //             \"status\": \"confirmed\",\n    //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    let currency = undefined;\n\n    if (code !== undefined) {\n      currency = this.currency(code);\n    }\n\n    return this.parseTransactions(result, currency, since, limit, {\n      'type': 'deposit'\n    });\n  }\n\n  async fetchWithdrawals(code = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const response = await this.privateGetWalletWithdrawals(params); //\n    //     {\n    //         \"success\": true,\n    //         \"result\": {\n    //             \"coin\": \"TUSD\",\n    //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n    //             \"tag\": \"null\",\n    //             \"fee\": 0,\n    //             \"id\": 1,\n    //             \"size\": \"99.0\",\n    //             \"status\": \"complete\",\n    //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n    //             \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n    //         }\n    //     }\n    //\n\n    const result = this.safeValue(response, 'result', []);\n    let currency = undefined;\n\n    if (code !== undefined) {\n      currency = this.currency(code);\n    }\n\n    return this.parseTransactions(result, currency, since, limit, {\n      'type': 'withdrawal'\n    });\n  }\n\n  sign(path, api = 'public', method = 'GET', params = {}, headers = undefined, body = undefined) {\n    let request = '/api/' + this.implodeParams(path, params);\n    const query = this.omit(params, this.extractParams(path));\n    const baseUrl = this.implodeParams(this.urls['api'][api], {\n      'hostname': this.hostname\n    });\n    let url = baseUrl + request;\n\n    if (method !== 'POST') {\n      if (Object.keys(query).length) {\n        const suffix = '?' + this.urlencode(query);\n        url += suffix;\n        request += suffix;\n      }\n    }\n\n    if (api === 'private') {\n      this.checkRequiredCredentials();\n      const timestamp = this.milliseconds().toString();\n      let auth = timestamp + method + request;\n      headers = {};\n\n      if (method === 'POST' || method === 'DELETE') {\n        body = this.json(query);\n        auth += body;\n        headers['Content-Type'] = 'application/json';\n      }\n\n      const signature = this.hmac(this.encode(auth), this.encode(this.secret), 'sha256');\n      const options = this.safeValue(this.options, 'sign', {});\n      const headerPrefix = this.safeString(options, this.hostname, 'FTX');\n      const keyField = headerPrefix + '-KEY';\n      const tsField = headerPrefix + '-TS';\n      const signField = headerPrefix + '-SIGN';\n      headers[keyField] = this.apiKey;\n      headers[tsField] = timestamp;\n      headers[signField] = signature;\n    }\n\n    return {\n      'url': url,\n      'method': method,\n      'body': body,\n      'headers': headers\n    };\n  }\n\n  handleErrors(code, reason, url, method, headers, body, response, requestHeaders, requestBody) {\n    if (response === undefined) {\n      return; // fallback to the default error handler\n    } //\n    //     {\"error\":\"Invalid parameter start_time\",\"success\":false}\n    //     {\"error\":\"Not enough balances\",\"success\":false}\n    //\n\n\n    const success = this.safeValue(response, 'success');\n\n    if (!success) {\n      const feedback = this.id + ' ' + body;\n      const error = this.safeString(response, 'error');\n      this.throwExactlyMatchedException(this.exceptions['exact'], error, feedback);\n      this.throwBroadlyMatchedException(this.exceptions['broad'], error, feedback);\n      throw new ExchangeError(feedback); // unknown message\n    }\n  }\n\n};","map":{"version":3,"sources":["C:/Users/James Price/Documents/VS Code/bixpro/node_modules/ccxt/js/ftx.js"],"names":["Exchange","require","TICK_SIZE","ExchangeError","InvalidOrder","BadRequest","InsufficientFunds","OrderNotFound","AuthenticationError","RateLimitExceeded","ExchangeNotAvailable","CancelPending","ArgumentsRequired","PermissionDenied","BadSymbol","DuplicateOrderId","Precise","module","exports","ftx","describe","deepExtend","fetchCurrencies","params","response","publicGetCoins","currencies","safeValue","result","i","length","currency","id","safeString","code","safeCurrencyCode","name","undefined","fetchMarkets","publicGetMarkets","markets","market","baseId","safeString2","quoteId","type","base","quote","symbol","active","sizeIncrement","safeNumber","priceIncrement","precision","push","parseTicker","ticker","marketId","markets_by_id","last","timestamp","safeTimestamp","milliseconds","iso8601","fetchTicker","loadMarkets","request","publicGetMarketsMarketName","extend","fetchTickers","symbols","tickers","parseTickers","fetchOrderBook","limit","publicGetMarketsMarketNameOrderbook","parseOrderBook","parseOHLCV","ohlcv","safeInteger","getMarketId","key","parts","getMarketParams","fetchOHLCV","timeframe","since","timeframes","seconds","parseTimeframe","parseInt","sum","publicGetMarketsMarketNameCandles","parseOHLCVs","parseTrade","trade","takerOrMaker","parse8601","priceString","amountString","price","parseNumber","amount","cost","stringMul","side","fee","feeCost","feeCurrencyId","feeCurrencyCode","orderId","fetchTrades","publicGetMarketsMarketNameTrades","parseTrades","fetchTradingFees","privateGetAccount","fetchBalance","privateGetWalletBalances","balances","balance","account","parseBalance","parseOrderStatus","status","statuses","parseOrder","order","filled","remaining","Math","max","average","safeNumber2","lastTradeTimestamp","clientOrderId","stopPrice","postOnly","createOrder","parseFloat","amountToPrecision","omit","method","priceToPrecision","editOrder","triggerPrice","orderPrice","trailValue","triggerPriceIsDefined","orderPriceIsDefined","trailValueIsDefined","cancelOrder","options","defaultMethod","safeValue2","query","cancelAllOrders","privateDeleteOrders","fetchOrder","fetchOpenOrders","parseOrders","fetchOrders","fetchMyTrades","privateGetFills","trades","withdraw","address","tag","checkAddress","password","privatePostWalletWithdrawals","parseTransaction","fetchPositions","fetchDepositAddress","privateGetWalletDepositAddressCoin","parseTransactionStatus","transaction","txid","notes","indexOf","slice","fetchDeposits","privateGetWalletDeposits","parseTransactions","fetchWithdrawals","privateGetWalletWithdrawals","sign","path","api","headers","body","implodeParams","extractParams","baseUrl","urls","hostname","url","Object","keys","suffix","urlencode","checkRequiredCredentials","toString","auth","json","signature","hmac","encode","secret","headerPrefix","keyField","tsField","signField","apiKey","handleErrors","reason","requestHeaders","requestBody","success","feedback","error","throwExactlyMatchedException","exceptions","throwBroadlyMatchedException"],"mappings":"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DE,EAAAA,UAAU,CAAEC,KAAF,EAASrF,MAAM,GAAGJ,SAAlB,EAA6B;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAML,EAAE,GAAG,KAAKC,UAAL,CAAiB6F,KAAjB,EAAwB,IAAxB,CAAX;AACA,UAAMlE,SAAS,GAAG,KAAKqC,SAAL,CAAgB,KAAKhE,UAAL,CAAiB6F,KAAjB,EAAwB,WAAxB,CAAhB,CAAlB;AACA,QAAIH,MAAM,GAAG,KAAKD,gBAAL,CAAuB,KAAKzF,UAAL,CAAiB6F,KAAjB,EAAwB,QAAxB,CAAvB,CAAb;AACA,UAAMxB,MAAM,GAAG,KAAKnD,UAAL,CAAiB2E,KAAjB,EAAwB,MAAxB,CAAf;AACA,UAAMC,MAAM,GAAG,KAAK5E,UAAL,CAAiB2E,KAAjB,EAAwB,YAAxB,CAAf;AACA,QAAIE,SAAS,GAAG,KAAK7E,UAAL,CAAiB2E,KAAjB,EAAwB,eAAxB,CAAhB;;AACA,QAAKE,SAAS,KAAK,GAAf,IAAwB1B,MAAM,KAAKjE,SAAnC,IAAkD0F,MAAM,KAAK1F,SAAjE,EAA6E;AACzE2F,MAAAA,SAAS,GAAGC,IAAI,CAACC,GAAL,CAAU5B,MAAM,GAAGyB,MAAnB,EAA2B,CAA3B,CAAZ;;AACA,UAAIC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","sourcesContent":["'use strict';\n\n//  ---------------------------------------------------------------------------\n\nconst Exchange = require ('./base/Exchange');\nconst { TICK_SIZE } = require ('./base/functions/number');\nconst { ExchangeError, InvalidOrder, BadRequest, InsufficientFunds, OrderNotFound, AuthenticationError, RateLimitExceeded, ExchangeNotAvailable, CancelPending, ArgumentsRequired, PermissionDenied, BadSymbol, DuplicateOrderId } = require ('./base/errors');\nconst Precise = require ('./base/Precise');\n\n//  ---------------------------------------------------------------------------\n\nmodule.exports = class ftx extends Exchange {\n    describe () {\n        return this.deepExtend (super.describe (), {\n            'id': 'ftx',\n            'name': 'FTX',\n            'countries': [ 'HK' ],\n            'rateLimit': 50,\n            'certified': true,\n            'pro': true,\n            'hostname': 'ftx.com', // or ftx.us\n            'urls': {\n                'logo': 'https://user-images.githubusercontent.com/1294454/67149189-df896480-f2b0-11e9-8816-41593e17f9ec.jpg',\n                'www': 'https://ftx.com',\n                'api': {\n                    'public': 'https://{hostname}',\n                    'private': 'https://{hostname}',\n                },\n                'doc': 'https://github.com/ftexchange/ftx',\n                'fees': 'https://ftexchange.zendesk.com/hc/en-us/articles/360024479432-Fees',\n                'referral': 'https://ftx.com/#a=1623029',\n            },\n            'has': {\n                'cancelAllOrders': true,\n                'cancelOrder': true,\n                'createOrder': true,\n                'editOrder': true,\n                'fetchBalance': true,\n                'fetchClosedOrders': false,\n                'fetchCurrencies': true,\n                'fetchDepositAddress': true,\n                'fetchDeposits': true,\n                'fetchFundingFees': false,\n                'fetchMarkets': true,\n                'fetchMyTrades': true,\n                'fetchOHLCV': true,\n                'fetchOpenOrders': true,\n                'fetchOrder': true,\n                'fetchOrderBook': true,\n                'fetchOrders': true,\n                'fetchPositions': true,\n                'fetchTicker': true,\n                'fetchTickers': true,\n                'fetchTrades': true,\n                'fetchTradingFees': true,\n                'fetchWithdrawals': true,\n                'withdraw': true,\n            },\n            'timeframes': {\n                '15s': '15',\n                '1m': '60',\n                '5m': '300',\n                '15m': '900',\n                '1h': '3600',\n                '4h': '14400',\n                '1d': '86400',\n            },\n            'api': {\n                'public': {\n                    'get': [\n                        'coins',\n                        'markets',\n                        'markets/{market_name}',\n                        'markets/{market_name}/orderbook', // ?depth={depth}\n                        'markets/{market_name}/trades', // ?limit={limit}&start_time={start_time}&end_time={end_time}\n                        'markets/{market_name}/candles', // ?resolution={resolution}&limit={limit}&start_time={start_time}&end_time={end_time}\n                        // futures\n                        'futures',\n                        'futures/{future_name}',\n                        'futures/{future_name}/stats',\n                        'funding_rates',\n                        'indexes/{index_name}/weights',\n                        'expired_futures',\n                        'indexes/{market_name}/candles', // ?resolution={resolution}&limit={limit}&start_time={start_time}&end_time={end_time}\n                        // leverage tokens\n                        'lt/tokens',\n                        'lt/{token_name}',\n                        // options\n                        'options/requests',\n                        'options/trades',\n                        'stats/24h_options_volume',\n                        'options/historical_volumes/BTC',\n                        'options/open_interest/BTC',\n                        'options/historical_open_interest/BTC',\n                        // spot margin\n                        'spot_margin/history',\n                    ],\n                },\n                'private': {\n                    'get': [\n                        'account',\n                        'positions',\n                        'wallet/coins',\n                        'wallet/balances',\n                        'wallet/all_balances',\n                        'wallet/deposit_address/{coin}', // ?method={method}\n                        'wallet/deposits',\n                        'wallet/withdrawals',\n                        'wallet/withdrawal_fee',\n                        'wallet/airdrops',\n                        'wallet/saved_addresses',\n                        'orders', // ?market={market}\n                        'orders/history', // ?market={market}\n                        'orders/{order_id}',\n                        'orders/by_client_id/{client_order_id}',\n                        'conditional_orders', // ?market={market}\n                        'conditional_orders/{conditional_order_id}/triggers',\n                        'conditional_orders/history', // ?market={market}\n                        'spot_margin/borrow_rates',\n                        'spot_margin/lending_rates',\n                        'spot_margin/borrow_summary',\n                        'spot_margin/market_info', // ?market={market}\n                        'spot_margin/borrow_history',\n                        'spot_margin/lending_history',\n                        'spot_margin/offers',\n                        'spot_margin/lending_info',\n                        'fills', // ?market={market}\n                        'funding_payments',\n                        // leverage tokens\n                        'lt/balances',\n                        'lt/creations',\n                        'lt/redemptions',\n                        // subaccounts\n                        'subaccounts',\n                        'subaccounts/{nickname}/balances',\n                        // otc\n                        'otc/quotes/{quoteId}',\n                        // options\n                        'options/my_requests',\n                        'options/requests/{request_id}/quotes',\n                        'options/my_quotes',\n                        'options/account_info',\n                        'options/positions',\n                        'options/fills',\n                        // staking\n                        'staking/stakes',\n                        'staking/unstake_requests',\n                        'staking/balances',\n                        'staking/staking_rewards',\n                    ],\n                    'post': [\n                        'account/leverage',\n                        'wallet/withdrawals',\n                        'wallet/saved_addresses',\n                        'orders',\n                        'conditional_orders',\n                        'orders/{order_id}/modify',\n                        'orders/by_client_id/{client_order_id}/modify',\n                        'conditional_orders/{order_id}/modify',\n                        // spot margin\n                        'spot_margin/offers',\n                        // leverage tokens\n                        'lt/{token_name}/create',\n                        'lt/{token_name}/redeem',\n                        // subaccounts\n                        'subaccounts',\n                        'subaccounts/update_name',\n                        'subaccounts/transfer',\n                        // otc\n                        'otc/quotes/{quote_id}/accept',\n                        'otc/quotes',\n                        // options\n                        'options/requests',\n                        'options/requests/{request_id}/quotes',\n                        'options/quotes/{quote_id}/accept',\n                        // staking\n                        'staking/unstake_requests',\n                        'srm_stakes/stakes',\n                    ],\n                    'delete': [\n                        'wallet/saved_addresses/{saved_address_id}',\n                        'orders/{order_id}',\n                        'orders/by_client_id/{client_order_id}',\n                        'orders',\n                        'conditional_orders/{order_id}',\n                        // subaccounts\n                        'subaccounts',\n                        // options\n                        'options/requests/{request_id}',\n                        'options/quotes/{quote_id}',\n                        // staking\n                        'staking/unstake_requests/{request_id}',\n                    ],\n                },\n            },\n            'fees': {\n                'trading': {\n                    'tierBased': true,\n                    'percentage': true,\n                    'maker': 0.02 / 100,\n                    'taker': 0.07 / 100,\n                    'tiers': {\n                        'taker': [\n                            [0, 0.07 / 100],\n                            [1000000, 0.06 / 100],\n                            [5000000, 0.055 / 100],\n                            [10000000, 0.05 / 100],\n                            [15000000, 0.045 / 100],\n                            [35000000, 0.04 / 100],\n                        ],\n                        'maker': [\n                            [0, 0.02 / 100],\n                            [1000000, 0.02 / 100],\n                            [5000000, 0.015 / 100],\n                            [10000000, 0.015 / 100],\n                            [15000000, 0.01 / 100],\n                            [35000000, 0.01 / 100],\n                        ],\n                    },\n                },\n                'funding': {\n                    'withdraw': {},\n                },\n            },\n            'exceptions': {\n                'exact': {\n                    'Please slow down': RateLimitExceeded, // {\"error\":\"Please slow down\",\"success\":false}\n                    'Size too small for provide': InvalidOrder, // {\"error\":\"Size too small for provide\",\"success\":false}\n                    'Not logged in': AuthenticationError, // {\"error\":\"Not logged in\",\"success\":false}\n                    'Not enough balances': InsufficientFunds, // {\"error\":\"Not enough balances\",\"success\":false}\n                    'InvalidPrice': InvalidOrder, // {\"error\":\"Invalid price\",\"success\":false}\n                    'Size too small': InvalidOrder, // {\"error\":\"Size too small\",\"success\":false}\n                    'Size too large': InvalidOrder, // {\"error\":\"Size too large\",\"success\":false}\n                    'Missing parameter price': InvalidOrder, // {\"error\":\"Missing parameter price\",\"success\":false}\n                    'Order not found': OrderNotFound, // {\"error\":\"Order not found\",\"success\":false}\n                    'Order already closed': InvalidOrder, // {\"error\":\"Order already closed\",\"success\":false}\n                    'Trigger price too high': InvalidOrder, // {\"error\":\"Trigger price too high\",\"success\":false}\n                    'Trigger price too low': InvalidOrder, // {\"error\":\"Trigger price too low\",\"success\":false}\n                    'Order already queued for cancellation': CancelPending, // {\"error\":\"Order already queued for cancellation\",\"success\":false}\n                    'Duplicate client order ID': DuplicateOrderId, // {\"error\":\"Duplicate client order ID\",\"success\":false}\n                    'Spot orders cannot be reduce-only': InvalidOrder, // {\"error\":\"Spot orders cannot be reduce-only\",\"success\":false}\n                    'Invalid reduce-only order': InvalidOrder, // {\"error\":\"Invalid reduce-only order\",\"success\":false}\n                },\n                'broad': {\n                    'Account does not have enough margin for order': InsufficientFunds,\n                    'Invalid parameter': BadRequest, // {\"error\":\"Invalid parameter start_time\",\"success\":false}\n                    'The requested URL was not found on the server': BadRequest,\n                    'No such coin': BadRequest,\n                    'No such market': BadSymbol,\n                    'Do not send more than': RateLimitExceeded,\n                    'An unexpected error occurred': ExchangeNotAvailable, // {\"error\":\"An unexpected error occurred, please try again later (58BC21C795).\",\"success\":false}\n                    'Please retry request': ExchangeNotAvailable, // {\"error\":\"Please retry request\",\"success\":false}\n                    'Please try again': ExchangeNotAvailable, // {\"error\":\"Please try again\",\"success\":false}\n                    'Try again': ExchangeNotAvailable, // {\"error\":\"Try again\",\"success\":false}\n                    'Only have permissions for subaccount': PermissionDenied, // {\"success\":false,\"error\":\"Only have permissions for subaccount *sub_name*\"}\n                },\n            },\n            'precisionMode': TICK_SIZE,\n            'options': {\n                // support for canceling conditional orders\n                // https://github.com/ccxt/ccxt/issues/6669\n                'cancelOrder': {\n                    'method': 'privateDeleteOrdersOrderId', // privateDeleteConditionalOrdersOrderId\n                },\n                'fetchOpenOrders': {\n                    'method': 'privateGetOrders', // privateGetConditionalOrders\n                },\n                'fetchOrders': {\n                    'method': 'privateGetOrdersHistory', // privateGetConditionalOrdersHistory\n                },\n                'sign': {\n                    'ftx.com': 'FTX',\n                    'ftx.us': 'FTXUS',\n                },\n            },\n        });\n    }\n\n    async fetchCurrencies (params = {}) {\n        const response = await this.publicGetCoins (params);\n        const currencies = this.safeValue (response, 'result', []);\n        //\n        //     {\n        //         \"success\":true,\n        //         \"result\": [\n        //             {\"id\":\"BTC\",\"name\":\"Bitcoin\"},\n        //             {\"id\":\"ETH\",\"name\":\"Ethereum\"},\n        //             {\"id\":\"ETHMOON\",\"name\":\"10X Long Ethereum Token\",\"underlying\":\"ETH\"},\n        //             {\"id\":\"EOSBULL\",\"name\":\"3X Long EOS Token\",\"underlying\":\"EOS\"},\n        //         ],\n        //     }\n        //\n        const result = {};\n        for (let i = 0; i < currencies.length; i++) {\n            const currency = currencies[i];\n            const id = this.safeString (currency, 'id');\n            const code = this.safeCurrencyCode (id);\n            const name = this.safeString (currency, 'name');\n            result[code] = {\n                'id': id,\n                'code': code,\n                'info': currency,\n                'type': undefined,\n                'name': name,\n                'active': undefined,\n                'fee': undefined,\n                'precision': undefined,\n                'limits': {\n                    'withdraw': { 'min': undefined, 'max': undefined },\n                    'amount': { 'min': undefined, 'max': undefined },\n                },\n            };\n        }\n        return result;\n    }\n\n    async fetchMarkets (params = {}) {\n        const response = await this.publicGetMarkets (params);\n        //\n        //     {\n        //         'success': true,\n        //         \"result\": [\n        //             {\n        //                 \"ask\":170.37,\n        //                 \"baseCurrency\":null,\n        //                 \"bid\":170.31,\n        //                 \"change1h\":-0.019001554672655036,\n        //                 \"change24h\":-0.024841165359738997,\n        //                 \"changeBod\":-0.03816406029469881,\n        //                 \"enabled\":true,\n        //                 \"last\":170.37,\n        //                 \"name\":\"ETH-PERP\",\n        //                 \"price\":170.37,\n        //                 \"priceIncrement\":0.01,\n        //                 \"quoteCurrency\":null,\n        //                 \"quoteVolume24h\":7742164.59889,\n        //                 \"sizeIncrement\":0.001,\n        //                 \"type\":\"future\",\n        //                 \"underlying\":\"ETH\",\n        //                 \"volumeUsd24h\":7742164.59889\n        //             },\n        //             {\n        //                 \"ask\":170.44,\n        //                 \"baseCurrency\":\"ETH\",\n        //                 \"bid\":170.41,\n        //                 \"change1h\":-0.018485459257126403,\n        //                 \"change24h\":-0.023825887743413515,\n        //                 \"changeBod\":-0.037605872388481086,\n        //                 \"enabled\":true,\n        //                 \"last\":172.72,\n        //                 \"name\":\"ETH/USD\",\n        //                 \"price\":170.44,\n        //                 \"priceIncrement\":0.01,\n        //                 \"quoteCurrency\":\"USD\",\n        //                 \"quoteVolume24h\":382802.0252,\n        //                 \"sizeIncrement\":0.001,\n        //                 \"type\":\"spot\",\n        //                 \"underlying\":null,\n        //                 \"volumeUsd24h\":382802.0252\n        //             },\n        //         ],\n        //     }\n        //\n        const result = [];\n        const markets = this.safeValue (response, 'result', []);\n        for (let i = 0; i < markets.length; i++) {\n            const market = markets[i];\n            const id = this.safeString (market, 'name');\n            const baseId = this.safeString2 (market, 'baseCurrency', 'underlying');\n            const quoteId = this.safeString (market, 'quoteCurrency', 'USD');\n            const type = this.safeString (market, 'type');\n            const base = this.safeCurrencyCode (baseId);\n            const quote = this.safeCurrencyCode (quoteId);\n            // check if a market is a spot or future market\n            const symbol = (type === 'future') ? this.safeString (market, 'name') : (base + '/' + quote);\n            const active = this.safeValue (market, 'enabled');\n            const sizeIncrement = this.safeNumber (market, 'sizeIncrement');\n            const priceIncrement = this.safeNumber (market, 'priceIncrement');\n            const precision = {\n                'amount': sizeIncrement,\n                'price': priceIncrement,\n            };\n            result.push ({\n                'id': id,\n                'symbol': symbol,\n                'base': base,\n                'quote': quote,\n                'baseId': baseId,\n                'quoteId': quoteId,\n                'type': type,\n                'future': (type === 'future'),\n                'spot': (type === 'spot'),\n                'active': active,\n                'precision': precision,\n                'limits': {\n                    'amount': {\n                        'min': sizeIncrement,\n                        'max': undefined,\n                    },\n                    'price': {\n                        'min': priceIncrement,\n                        'max': undefined,\n                    },\n                    'cost': {\n                        'min': undefined,\n                        'max': undefined,\n                    },\n                },\n                'info': market,\n            });\n        }\n        return result;\n    }\n\n    parseTicker (ticker, market = undefined) {\n        //\n        //     {\n        //         \"ask\":171.29,\n        //         \"baseCurrency\":null, // base currency for spot markets\n        //         \"bid\":171.24,\n        //         \"change1h\":-0.0012244897959183673,\n        //         \"change24h\":-0.031603346901854366,\n        //         \"changeBod\":-0.03297013492914808,\n        //         \"enabled\":true,\n        //         \"last\":171.44,\n        //         \"name\":\"ETH-PERP\",\n        //         \"price\":171.29,\n        //         \"priceIncrement\":0.01,\n        //         \"quoteCurrency\":null, // quote currency for spot markets\n        //         \"quoteVolume24h\":8570651.12113,\n        //         \"sizeIncrement\":0.001,\n        //         \"type\":\"future\",\n        //         \"underlying\":\"ETH\", // null for spot markets\n        //         \"volumeUsd24h\":8570651.12113,\n        //     }\n        //\n        let symbol = undefined;\n        const marketId = this.safeString (ticker, 'name');\n        if (marketId in this.markets_by_id) {\n            market = this.markets_by_id[marketId];\n        } else {\n            const type = this.safeString (ticker, 'type');\n            if (type === 'future') {\n                symbol = marketId;\n            } else {\n                const base = this.safeCurrencyCode (this.safeString (ticker, 'baseCurrency'));\n                const quote = this.safeCurrencyCode (this.safeString (ticker, 'quoteCurrency'));\n                if ((base !== undefined) && (quote !== undefined)) {\n                    symbol = base + '/' + quote;\n                }\n            }\n        }\n        if ((symbol === undefined) && (market !== undefined)) {\n            symbol = market['symbol'];\n        }\n        const last = this.safeNumber (ticker, 'last');\n        const timestamp = this.safeTimestamp (ticker, 'time', this.milliseconds ());\n        return {\n            'symbol': symbol,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'high': this.safeNumber (ticker, 'high'),\n            'low': this.safeNumber (ticker, 'low'),\n            'bid': this.safeNumber (ticker, 'bid'),\n            'bidVolume': this.safeNumber (ticker, 'bidSize'),\n            'ask': this.safeNumber (ticker, 'ask'),\n            'askVolume': this.safeNumber (ticker, 'askSize'),\n            'vwap': undefined,\n            'open': undefined,\n            'close': last,\n            'last': last,\n            'previousClose': undefined,\n            'change': undefined,\n            'percentage': this.safeNumber (ticker, 'change24h'),\n            'average': undefined,\n            'baseVolume': undefined,\n            'quoteVolume': this.safeNumber (ticker, 'quoteVolume24h'),\n            'info': ticker,\n        };\n    }\n\n    async fetchTicker (symbol, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market_name': market['id'],\n        };\n        const response = await this.publicGetMarketsMarketName (this.extend (request, params));\n        //\n        //     {\n        //         \"success\":true,\n        //         \"result\":{\n        //             \"ask\":171.29,\n        //             \"baseCurrency\":null, // base currency for spot markets\n        //             \"bid\":171.24,\n        //             \"change1h\":-0.0012244897959183673,\n        //             \"change24h\":-0.031603346901854366,\n        //             \"changeBod\":-0.03297013492914808,\n        //             \"enabled\":true,\n        //             \"last\":171.44,\n        //             \"name\":\"ETH-PERP\",\n        //             \"price\":171.29,\n        //             \"priceIncrement\":0.01,\n        //             \"quoteCurrency\":null, // quote currency for spot markets\n        //             \"quoteVolume24h\":8570651.12113,\n        //             \"sizeIncrement\":0.001,\n        //             \"type\":\"future\",\n        //             \"underlying\":\"ETH\", // null for spot markets\n        //             \"volumeUsd24h\":8570651.12113,\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return this.parseTicker (result, market);\n    }\n\n    async fetchTickers (symbols = undefined, params = {}) {\n        await this.loadMarkets ();\n        const response = await this.publicGetMarkets (params);\n        //\n        //     {\n        //         'success': true,\n        //         \"result\": [\n        //             {\n        //                 \"ask\":170.44,\n        //                 \"baseCurrency\":\"ETH\",\n        //                 \"bid\":170.41,\n        //                 \"change1h\":-0.018485459257126403,\n        //                 \"change24h\":-0.023825887743413515,\n        //                 \"changeBod\":-0.037605872388481086,\n        //                 \"enabled\":true,\n        //                 \"last\":172.72,\n        //                 \"name\":\"ETH/USD\",\n        //                 \"price\":170.44,\n        //                 \"priceIncrement\":0.01,\n        //                 \"quoteCurrency\":\"USD\",\n        //                 \"quoteVolume24h\":382802.0252,\n        //                 \"sizeIncrement\":0.001,\n        //                 \"type\":\"spot\",\n        //                 \"underlying\":null,\n        //                 \"volumeUsd24h\":382802.0252\n        //             },\n        //         ],\n        //     }\n        //\n        const tickers = this.safeValue (response, 'result', []);\n        return this.parseTickers (tickers, symbols);\n    }\n\n    async fetchOrderBook (symbol, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market_name': market['id'],\n        };\n        if (limit !== undefined) {\n            request['depth'] = limit; // max 100, default 20\n        }\n        const response = await this.publicGetMarketsMarketNameOrderbook (this.extend (request, params));\n        //\n        //     {\n        //         \"success\":true,\n        //         \"result\":{\n        //             \"asks\":[\n        //                 [171.95,279.865],\n        //                 [171.98,102.42],\n        //                 [171.99,124.11],\n        //             ],\n        //             \"bids\":[\n        //                 [171.93,69.749],\n        //                 [171.9,288.325],\n        //                 [171.88,87.47],\n        //             ],\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return this.parseOrderBook (result, symbol);\n    }\n\n    parseOHLCV (ohlcv, market = undefined) {\n        //\n        //     {\n        //         \"close\":177.23,\n        //         \"high\":177.45,\n        //         \"low\":177.2,\n        //         \"open\":177.43,\n        //         \"startTime\":\"2019-10-17T13:27:00+00:00\",\n        //         \"time\":1571318820000.0,\n        //         \"volume\":0.0\n        //     }\n        //\n        return [\n            this.safeInteger (ohlcv, 'time'),\n            this.safeNumber (ohlcv, 'open'),\n            this.safeNumber (ohlcv, 'high'),\n            this.safeNumber (ohlcv, 'low'),\n            this.safeNumber (ohlcv, 'close'),\n            this.safeNumber (ohlcv, 'volume'),\n        ];\n    }\n\n    getMarketId (symbol, key, params = {}) {\n        const parts = this.getMarketParams (symbol, key, params);\n        return this.safeString (parts, 1, symbol);\n    }\n\n    getMarketParams (symbol, key, params = {}) {\n        let market = undefined;\n        let marketId = undefined;\n        if (symbol in this.markets) {\n            market = this.market (symbol);\n            marketId = market['id'];\n        } else {\n            marketId = this.safeString (params, key, symbol);\n        }\n        return [ market, marketId ];\n    }\n\n    async fetchOHLCV (symbol, timeframe = '1m', since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const [ market, marketId ] = this.getMarketParams (symbol, 'market_name', params);\n        const request = {\n            'resolution': this.timeframes[timeframe],\n            'market_name': marketId,\n        };\n        // max 1501 candles, including the current candle when since is not specified\n        limit = (limit === undefined) ? 1501 : limit;\n        if (since === undefined) {\n            request['end_time'] = this.seconds ();\n            request['limit'] = limit;\n            request['start_time'] = request['end_time'] - limit * this.parseTimeframe (timeframe);\n        } else {\n            request['start_time'] = parseInt (since / 1000);\n            request['limit'] = limit;\n            request['end_time'] = this.sum (request['start_time'], limit * this.parseTimeframe (timeframe));\n        }\n        const response = await this.publicGetMarketsMarketNameCandles (this.extend (request, params));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\":[\n        //             {\n        //                 \"close\":177.23,\n        //                 \"high\":177.45,\n        //                 \"low\":177.2,\n        //                 \"open\":177.43,\n        //                 \"startTime\":\"2019-10-17T13:27:00+00:00\",\n        //                 \"time\":1571318820000.0,\n        //                 \"volume\":0.0\n        //             },\n        //             {\n        //                 \"close\":177.26,\n        //                 \"high\":177.33,\n        //                 \"low\":177.23,\n        //                 \"open\":177.23,\n        //                 \"startTime\":\"2019-10-17T13:28:00+00:00\",\n        //                 \"time\":1571318880000.0,\n        //                 \"volume\":0.0\n        //             },\n        //         ],\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        return this.parseOHLCVs (result, market, timeframe, since, limit);\n    }\n\n    parseTrade (trade, market = undefined) {\n        //\n        // fetchTrades (public)\n        //\n        //     {\n        //         \"id\":1715826,\n        //         \"liquidation\":false,\n        //         \"price\":171.62,\n        //         \"side\":\"buy\",\n        //         \"size\":2.095,\n        //         \"time\":\"2019-10-18T12:59:54.288166+00:00\"\n        //     }\n        //\n        // fetchMyTrades (private)\n        //\n        //     {\n        //         \"fee\": 20.1374935,\n        //         \"feeRate\": 0.0005,\n        //         \"feeCurrency\": \"USD\",\n        //         \"future\": \"EOS-0329\",\n        //         \"id\": 11215,\n        //         \"liquidity\": \"taker\",\n        //         \"market\": \"EOS-0329\",\n        //         \"baseCurrency\": null,\n        //         \"quoteCurrency\": null,\n        //         \"orderId\": 8436981,\n        //         \"price\": 4.201,\n        //         \"side\": \"buy\",\n        //         \"size\": 9587,\n        //         \"time\": \"2019-03-27T19:15:10.204619+00:00\",\n        //         \"type\": \"order\"\n        //     }\n        //\n        //     {\n        //         \"baseCurrency\": \"BTC\",\n        //         \"fee\": 0,\n        //         \"feeCurrency\": \"USD\",\n        //         \"feeRate\": 0,\n        //         \"future\": null,\n        //         \"id\": 664079556,\n        //         \"liquidity\": \"taker\",\n        //         \"market\": null,\n        //         \"orderId\": null,\n        //         \"price\": 34830.61359,\n        //         \"quoteCurrency\": \"USD\",\n        //         \"side\": \"sell\",\n        //         \"size\": 0.0005996,\n        //         \"time\": \"2021-01-15T16:05:29.246135+00:00\",\n        //         \"tradeId\": null,\n        //         \"type\": \"otc\"\n        //     }\n        //\n        //     with -ve fee\n        //     {\n        //         \"id\": 1171258927,\n        //         \"fee\": -0.0000713875,\n        //         \"side\": \"sell\",\n        //         \"size\": 1,\n        //         \"time\": \"2021-03-11T13:34:35.523627+00:00\",\n        //         \"type\": \"order\",\n        //         \"price\": 14.2775,\n        //         \"future\": null,\n        //         \"market\": \"SOL/USD\",\n        //         \"feeRate\": -0.000005,\n        //         \"orderId\": 33182929044,\n        //         \"tradeId\": 582936801,\n        //         \"liquidity\": \"maker\",\n        //         \"feeCurrency\": \"USD\",\n        //         \"baseCurrency\": \"SOL\",\n        //         \"quoteCurrency\": \"USD\"\n        //     }\n        //\n        //     // from OTC order\n        //     {\n        //         \"id\": 1172129651,\n        //         \"fee\": 0,\n        //         \"side\": \"sell\",\n        //         \"size\": 1.47568846,\n        //         \"time\": \"2021-03-11T15:04:46.893383+00:00\",\n        //         \"type\": \"otc\",\n        //         \"price\": 14.60932598,\n        //         \"future\": null,\n        //         \"market\": null,\n        //         \"feeRate\": 0,\n        //         \"orderId\": null,\n        //         \"tradeId\": null,\n        //         \"liquidity\": \"taker\",\n        //         \"feeCurrency\": \"USD\",\n        //         \"baseCurrency\": \"BCHA\",\n        //         \"quoteCurrency\": \"USD\"\n        //     }\n        const id = this.safeString (trade, 'id');\n        const takerOrMaker = this.safeString (trade, 'liquidity');\n        const marketId = this.safeString (trade, 'market');\n        let symbol = undefined;\n        if (marketId in this.markets_by_id) {\n            market = this.markets_by_id[marketId];\n            symbol = market['symbol'];\n        } else {\n            const base = this.safeCurrencyCode (this.safeString (trade, 'baseCurrency'));\n            const quote = this.safeCurrencyCode (this.safeString (trade, 'quoteCurrency'));\n            if ((base !== undefined) && (quote !== undefined)) {\n                symbol = base + '/' + quote;\n            } else {\n                symbol = marketId;\n            }\n        }\n        const timestamp = this.parse8601 (this.safeString (trade, 'time'));\n        const priceString = this.safeString (trade, 'price');\n        const amountString = this.safeString (trade, 'size');\n        const price = this.parseNumber (priceString);\n        const amount = this.parseNumber (amountString);\n        const cost = this.parseNumber (Precise.stringMul (priceString, amountString));\n        if ((symbol === undefined) && (market !== undefined)) {\n            symbol = market['symbol'];\n        }\n        const side = this.safeString (trade, 'side');\n        let fee = undefined;\n        const feeCost = this.safeNumber (trade, 'fee');\n        if (feeCost !== undefined) {\n            const feeCurrencyId = this.safeString (trade, 'feeCurrency');\n            const feeCurrencyCode = this.safeCurrencyCode (feeCurrencyId);\n            fee = {\n                'cost': feeCost,\n                'currency': feeCurrencyCode,\n                'rate': this.safeNumber (trade, 'feeRate'),\n            };\n        }\n        const orderId = this.safeString (trade, 'orderId');\n        return {\n            'info': trade,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'symbol': symbol,\n            'id': id,\n            'order': orderId,\n            'type': undefined,\n            'takerOrMaker': takerOrMaker,\n            'side': side,\n            'price': price,\n            'amount': amount,\n            'cost': cost,\n            'fee': fee,\n        };\n    }\n\n    async fetchTrades (symbol, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const [ market, marketId ] = this.getMarketParams (symbol, 'market_name', params);\n        const request = {\n            'market_name': marketId,\n        };\n        if (since !== undefined) {\n            request['start_time'] = parseInt (since / 1000);\n            // start_time doesn't work without end_time\n            request['end_time'] = this.seconds ();\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        const response = await this.publicGetMarketsMarketNameTrades (this.extend (request, params));\n        //\n        //     {\n        //         \"success\":true,\n        //         \"result\":[\n        //             {\n        //                 \"id\":1715826,\n        //                 \"liquidation\":false,\n        //                 \"price\":171.62,\n        //                 \"side\":\"buy\",\n        //                 \"size\":2.095,\n        //                 \"time\":\"2019-10-18T12:59:54.288166+00:00\"\n        //             },\n        //             {\n        //                 \"id\":1715763,\n        //                 \"liquidation\":false,\n        //                 \"price\":171.89,\n        //                 \"side\":\"sell\",\n        //                 \"size\":1.477,\n        //                 \"time\":\"2019-10-18T12:58:38.443734+00:00\"\n        //             },\n        //         ],\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        return this.parseTrades (result, market, since, limit);\n    }\n\n    async fetchTradingFees (params = {}) {\n        await this.loadMarkets ();\n        const response = await this.privateGetAccount (params);\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"backstopProvider\": true,\n        //             \"collateral\": 3568181.02691129,\n        //             \"freeCollateral\": 1786071.456884368,\n        //             \"initialMarginRequirement\": 0.12222384240257728,\n        //             \"liquidating\": false,\n        //             \"maintenanceMarginRequirement\": 0.07177992558058484,\n        //             \"makerFee\": 0.0002,\n        //             \"marginFraction\": 0.5588433331419503,\n        //             \"openMarginFraction\": 0.2447194090423075,\n        //             \"takerFee\": 0.0005,\n        //             \"totalAccountValue\": 3568180.98341129,\n        //             \"totalPositionSize\": 6384939.6992,\n        //             \"username\": \"user@domain.com\",\n        //             \"positions\": [\n        //                 {\n        //                     \"cost\": -31.7906,\n        //                     \"entryPrice\": 138.22,\n        //                     \"future\": \"ETH-PERP\",\n        //                     \"initialMarginRequirement\": 0.1,\n        //                     \"longOrderSize\": 1744.55,\n        //                     \"maintenanceMarginRequirement\": 0.04,\n        //                     \"netSize\": -0.23,\n        //                     \"openSize\": 1744.32,\n        //                     \"realizedPnl\": 3.39441714,\n        //                     \"shortOrderSize\": 1732.09,\n        //                     \"side\": \"sell\",\n        //                     \"size\": 0.23,\n        //                     \"unrealizedPnl\": 0,\n        //                 },\n        //             ],\n        //         },\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return {\n            'info': response,\n            'maker': this.safeNumber (result, 'makerFee'),\n            'taker': this.safeNumber (result, 'takerFee'),\n        };\n    }\n\n    async fetchBalance (params = {}) {\n        await this.loadMarkets ();\n        const response = await this.privateGetWalletBalances (params);\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"coin\": \"USDTBEAR\",\n        //                 \"free\": 2320.2,\n        //                 \"total\": 2340.2\n        //             },\n        //         ],\n        //     }\n        //\n        const result = {\n            'info': response,\n        };\n        const balances = this.safeValue (response, 'result', []);\n        for (let i = 0; i < balances.length; i++) {\n            const balance = balances[i];\n            const code = this.safeCurrencyCode (this.safeString (balance, 'coin'));\n            const account = this.account ();\n            account['free'] = this.safeString (balance, 'free');\n            account['total'] = this.safeString (balance, 'total');\n            result[code] = account;\n        }\n        return this.parseBalance (result, false);\n    }\n\n    parseOrderStatus (status) {\n        const statuses = {\n            'new': 'open',\n            'open': 'open',\n            'closed': 'closed', // filled or canceled\n            'triggered': 'closed',\n        };\n        return this.safeString (statuses, status, status);\n    }\n\n    parseOrder (order, market = undefined) {\n        //\n        // limit orders - fetchOrder, fetchOrders, fetchOpenOrders, createOrder, editOrder\n        //\n        //     {\n        //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"filledSize\": 0,\n        //         \"future\": \"XRP-PERP\",\n        //         \"id\": 9596912,\n        //         \"market\": \"XRP-PERP\",\n        //         \"price\": 0.306525,\n        //         \"remainingSize\": 31431,\n        //         \"side\": \"sell\",\n        //         \"size\": 31431,\n        //         \"status\": \"open\",\n        //         \"type\": \"limit\",\n        //         \"reduceOnly\": false,\n        //         \"ioc\": false,\n        //         \"postOnly\": false,\n        //         \"clientId\": null,\n        //     }\n        //\n        // market orders - fetchOrder, fetchOrders, fetchOpenOrders, createOrder\n        //\n        //     {\n        //         \"avgFillPrice\": 2666.0,\n        //         \"clientId\": None,\n        //         \"createdAt\": \"2020-02-12T00: 53: 49.009726+00: 00\",\n        //         \"filledSize\": 0.0007,\n        //         \"future\": None,\n        //         \"id\": 3109208514,\n        //         \"ioc\": True,\n        //         \"market\": \"BNBBULL/USD\",\n        //         \"postOnly\": False,\n        //         \"price\": None,\n        //         \"reduceOnly\": False,\n        //         \"remainingSize\": 0.0,\n        //         \"side\": \"buy\",\n        //         \"size\": 0.0007,\n        //         \"status\": \"closed\",\n        //         \"type\": \"market\"\n        //     }\n        //\n        // createOrder (conditional, \"stop\", \"trailingStop\", or \"takeProfit\")\n        //\n        //     {\n        //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"future\": \"XRP-PERP\",\n        //         \"id\": 9596912,\n        //         \"market\": \"XRP-PERP\",\n        //         \"triggerPrice\": 0.306525,\n        //         \"orderId\": null,\n        //         \"side\": \"sell\",\n        //         \"size\": 31431,\n        //         \"status\": \"open\",\n        //         \"type\": \"stop\",\n        //         \"orderPrice\": null,\n        //         \"error\": null,\n        //         \"triggeredAt\": null,\n        //         \"reduceOnly\": false\n        //     }\n        //\n        // editOrder (conditional, stop, trailing stop, take profit)\n        //\n        //     {\n        //         \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"future\": \"XRP-PERP\",\n        //         \"id\": 9596912,\n        //         \"market\": \"XRP-PERP\",\n        //         \"triggerPrice\": 0.306225,\n        //         \"orderId\": null,\n        //         \"side\": \"sell\",\n        //         \"size\": 31431,\n        //         \"status\": \"open\",\n        //         \"type\": \"stop\",\n        //         \"orderPrice\": null,\n        //         \"error\": null,\n        //         \"triggeredAt\": null,\n        //         \"reduceOnly\": false,\n        //         \"orderType\": \"market\",\n        //         \"filledSize\": 0,\n        //         \"avgFillPrice\": null,\n        //         \"retryUntilFilled\": false\n        //     }\n        //\n        // canceled order with a closed status\n        //\n        //     {\n        //         \"avgFillPrice\":null,\n        //         \"clientId\":null,\n        //         \"createdAt\":\"2020-09-01T13:45:57.119695+00:00\",\n        //         \"filledSize\":0.0,\n        //         \"future\":null,\n        //         \"id\":8553541288,\n        //         \"ioc\":false,\n        //         \"liquidation\":false,\n        //         \"market\":\"XRP/USDT\",\n        //         \"postOnly\":false,\n        //         \"price\":0.5,\n        //         \"reduceOnly\":false,\n        //         \"remainingSize\":0.0,\n        //         \"side\":\"sell\",\n        //         \"size\":46.0,\n        //         \"status\":\"closed\",\n        //         \"type\":\"limit\"\n        //     }\n        //\n        const id = this.safeString (order, 'id');\n        const timestamp = this.parse8601 (this.safeString (order, 'createdAt'));\n        let status = this.parseOrderStatus (this.safeString (order, 'status'));\n        const amount = this.safeNumber (order, 'size');\n        const filled = this.safeNumber (order, 'filledSize');\n        let remaining = this.safeNumber (order, 'remainingSize');\n        if ((remaining === 0.0) && (amount !== undefined) && (filled !== undefined)) {\n            remaining = Math.max (amount - filled, 0);\n            if (remaining > 0) {\n                status = 'canceled';\n            }\n        }\n        let symbol = undefined;\n        const marketId = this.safeString (order, 'market');\n        if (marketId !== undefined) {\n            if (marketId in this.markets_by_id) {\n                market = this.markets_by_id[marketId];\n                symbol = market['symbol'];\n            } else {\n                // support for delisted market ids\n                // https://github.com/ccxt/ccxt/issues/7113\n                symbol = marketId;\n            }\n        }\n        if ((symbol === undefined) && (market !== undefined)) {\n            symbol = market['symbol'];\n        }\n        const side = this.safeString (order, 'side');\n        const type = this.safeString (order, 'type');\n        const average = this.safeNumber (order, 'avgFillPrice');\n        const price = this.safeNumber2 (order, 'price', 'triggerPrice', average);\n        let cost = undefined;\n        if (filled !== undefined && price !== undefined) {\n            cost = filled * price;\n        }\n        const lastTradeTimestamp = this.parse8601 (this.safeString (order, 'triggeredAt'));\n        const clientOrderId = this.safeString (order, 'clientId');\n        const stopPrice = this.safeNumber (order, 'triggerPrice');\n        const postOnly = this.safeValue (order, 'postOnly');\n        return {\n            'info': order,\n            'id': id,\n            'clientOrderId': clientOrderId,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'lastTradeTimestamp': lastTradeTimestamp,\n            'symbol': symbol,\n            'type': type,\n            'timeInForce': undefined,\n            'postOnly': postOnly,\n            'side': side,\n            'price': price,\n            'stopPrice': stopPrice,\n            'amount': amount,\n            'cost': cost,\n            'average': average,\n            'filled': filled,\n            'remaining': remaining,\n            'status': status,\n            'fee': undefined,\n            'trades': undefined,\n        };\n    }\n\n    async createOrder (symbol, type, side, amount, price = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market': market['id'],\n            'side': side, // \"buy\" or \"sell\"\n            // 'price': 0.306525, // send null for market orders\n            'type': type, // \"limit\", \"market\", \"stop\", \"trailingStop\", or \"takeProfit\"\n            'size': parseFloat (this.amountToPrecision (symbol, amount)),\n            // 'reduceOnly': false, // optional, default is false\n            // 'ioc': false, // optional, default is false, limit or market orders only\n            // 'postOnly': false, // optional, default is false, limit or market orders only\n            // 'clientId': 'abcdef0123456789', // string, optional, client order id, limit or market orders only\n        };\n        const clientOrderId = this.safeString2 (params, 'clientId', 'clientOrderId');\n        if (clientOrderId !== undefined) {\n            request['clientId'] = clientOrderId;\n            params = this.omit (params, [ 'clientId', 'clientOrderId' ]);\n        }\n        let method = undefined;\n        if (type === 'limit') {\n            method = 'privatePostOrders';\n            request['price'] = parseFloat (this.priceToPrecision (symbol, price));\n        } else if (type === 'market') {\n            method = 'privatePostOrders';\n            request['price'] = null;\n        } else if ((type === 'stop') || (type === 'takeProfit')) {\n            method = 'privatePostConditionalOrders';\n            const stopPrice = this.safeNumber2 (params, 'stopPrice', 'triggerPrice');\n            if (stopPrice === undefined) {\n                throw new ArgumentsRequired (this.id + ' createOrder () requires a stopPrice parameter or a triggerPrice parameter for ' + type + ' orders');\n            } else {\n                params = this.omit (params, [ 'stopPrice', 'triggerPrice' ]);\n                request['triggerPrice'] = parseFloat (this.priceToPrecision (symbol, stopPrice));\n            }\n            if (price !== undefined) {\n                request['orderPrice'] = parseFloat (this.priceToPrecision (symbol, price)); // optional, order type is limit if this is specified, otherwise market\n            }\n        } else if (type === 'trailingStop') {\n            method = 'privatePostConditionalOrders';\n            request['trailValue'] = parseFloat (this.priceToPrecision (symbol, price)); // negative for \"sell\", positive for \"buy\"\n        } else {\n            throw new InvalidOrder (this.id + ' createOrder () does not support order type ' + type + ', only limit, market, stop, trailingStop, or takeProfit orders are supported');\n        }\n        const response = await this[method] (this.extend (request, params));\n        //\n        // orders\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //                 \"filledSize\": 0,\n        //                 \"future\": \"XRP-PERP\",\n        //                 \"id\": 9596912,\n        //                 \"market\": \"XRP-PERP\",\n        //                 \"price\": 0.306525,\n        //                 \"remainingSize\": 31431,\n        //                 \"side\": \"sell\",\n        //                 \"size\": 31431,\n        //                 \"status\": \"open\",\n        //                 \"type\": \"limit\",\n        //                 \"reduceOnly\": false,\n        //                 \"ioc\": false,\n        //                 \"postOnly\": false,\n        //                 \"clientId\": null,\n        //             }\n        //         ]\n        //     }\n        //\n        // conditional orders\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //                 \"future\": \"XRP-PERP\",\n        //                 \"id\": 9596912,\n        //                 \"market\": \"XRP-PERP\",\n        //                 \"triggerPrice\": 0.306525,\n        //                 \"orderId\": null,\n        //                 \"side\": \"sell\",\n        //                 \"size\": 31431,\n        //                 \"status\": \"open\",\n        //                 \"type\": \"stop\",\n        //                 \"orderPrice\": null,\n        //                 \"error\": null,\n        //                 \"triggeredAt\": null,\n        //                 \"reduceOnly\": false\n        //             }\n        //         ]\n        //     }\n        //\n        //\n        const result = this.safeValue (response, 'result', []);\n        return this.parseOrder (result, market);\n    }\n\n    async editOrder (id, symbol, type, side, amount, price = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {};\n        let method = undefined;\n        const clientOrderId = this.safeString2 (params, 'client_order_id', 'clientOrderId');\n        const triggerPrice = this.safeNumber (params, 'triggerPrice');\n        const orderPrice = this.safeNumber (params, 'orderPrice');\n        const trailValue = this.safeNumber (params, 'trailValue');\n        params = this.omit (params, [ 'client_order_id', 'clientOrderId', 'triggerPrice', 'orderPrice', 'trailValue' ]);\n        const triggerPriceIsDefined = (triggerPrice !== undefined);\n        const orderPriceIsDefined = (orderPrice !== undefined);\n        const trailValueIsDefined = (trailValue !== undefined);\n        if (triggerPriceIsDefined || orderPriceIsDefined || trailValueIsDefined) {\n            method = 'privatePostConditionalOrdersOrderIdModify';\n            request['order_id'] = id;\n            if (triggerPriceIsDefined) {\n                request['triggerPrice'] = parseFloat (this.priceToPrecision (symbol, triggerPrice));\n            }\n            if (orderPriceIsDefined) {\n                // only for stop limit or take profit limit orders\n                request['orderPrice'] = parseFloat (this.priceToPrecision (symbol, orderPrice));\n            }\n            if (trailValueIsDefined) {\n                // negative for sell orders, positive for buy orders\n                request['trailValue'] = parseFloat (this.priceToPrecision (symbol, trailValue));\n            }\n        } else {\n            if (clientOrderId === undefined) {\n                method = 'privatePostOrdersOrderIdModify';\n                request['order_id'] = id;\n            } else {\n                method = 'privatePostOrdersByClientIdClientOrderIdModify';\n                request['client_order_id'] = clientOrderId;\n                // request['clientId'] = clientOrderId;\n            }\n            if (price !== undefined) {\n                request['price'] = parseFloat (this.priceToPrecision (symbol, price));\n            }\n        }\n        if (amount !== undefined) {\n            request['size'] = parseFloat (this.amountToPrecision (symbol, amount));\n        }\n        const response = await this[method] (this.extend (request, params));\n        //\n        // regular order\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"createdAt\": \"2019-03-05T11:56:55.728933+00:00\",\n        //             \"filledSize\": 0,\n        //             \"future\": \"XRP-PERP\",\n        //             \"id\": 9596932,\n        //             \"market\": \"XRP-PERP\",\n        //             \"price\": 0.326525,\n        //             \"remainingSize\": 31431,\n        //             \"side\": \"sell\",\n        //             \"size\": 31431,\n        //             \"status\": \"open\",\n        //             \"type\": \"limit\",\n        //             \"reduceOnly\": false,\n        //             \"ioc\": false,\n        //             \"postOnly\": false,\n        //             \"clientId\": null,\n        //         }\n        //     }\n        //\n        // conditional trigger order\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"future\": \"XRP-PERP\",\n        //             \"id\": 9596912,\n        //             \"market\": \"XRP-PERP\",\n        //             \"triggerPrice\": 0.306225,\n        //             \"orderId\": null,\n        //             \"side\": \"sell\",\n        //             \"size\": 31431,\n        //             \"status\": \"open\",\n        //             \"type\": \"stop\",\n        //             \"orderPrice\": null,\n        //             \"error\": null,\n        //             \"triggeredAt\": null,\n        //             \"reduceOnly\": false,\n        //             \"orderType\": \"market\",\n        //             \"filledSize\": 0,\n        //             \"avgFillPrice\": null,\n        //             \"retryUntilFilled\": false\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return this.parseOrder (result, market);\n    }\n\n    async cancelOrder (id, symbol = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {};\n        // support for canceling conditional orders\n        // https://github.com/ccxt/ccxt/issues/6669\n        const options = this.safeValue (this.options, 'cancelOrder', {});\n        const defaultMethod = this.safeString (options, 'method', 'privateDeleteOrdersOrderId');\n        let method = this.safeString (params, 'method', defaultMethod);\n        const type = this.safeValue (params, 'type');\n        const clientOrderId = this.safeValue2 (params, 'client_order_id', 'clientOrderId');\n        if (clientOrderId === undefined) {\n            request['order_id'] = parseInt (id);\n            if ((type === 'stop') || (type === 'trailingStop') || (type === 'takeProfit')) {\n                method = 'privateDeleteConditionalOrdersOrderId';\n            }\n        } else {\n            request['client_order_id'] = clientOrderId;\n            method = 'privateDeleteOrdersByClientIdClientOrderId';\n        }\n        const query = this.omit (params, [ 'method', 'type', 'client_order_id', 'clientOrderId' ]);\n        const response = await this[method] (this.extend (request, query));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": \"Order queued for cancelation\"\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return result;\n    }\n\n    async cancelAllOrders (symbol = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {\n            // 'market': market['id'], // optional\n            // 'conditionalOrdersOnly': false, // cancel conditional orders only\n            // 'limitOrdersOnly': false, // cancel existing limit orders (non-conditional orders) only\n        };\n        const marketId = this.getMarketId (symbol, 'market', params);\n        if (marketId !== undefined) {\n            request['market'] = marketId;\n        }\n        const response = await this.privateDeleteOrders (this.extend (request, params));\n        const result = this.safeValue (response, 'result', {});\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": \"Orders queued for cancelation\"\n        //     }\n        //\n        return result;\n    }\n\n    async fetchOrder (id, symbol = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {};\n        const clientOrderId = this.safeValue2 (params, 'client_order_id', 'clientOrderId');\n        let method = 'privateGetOrdersOrderId';\n        if (clientOrderId === undefined) {\n            request['order_id'] = id;\n        } else {\n            request['client_order_id'] = clientOrderId;\n            params = this.omit (params, [ 'client_order_id', 'clientOrderId']);\n            method = 'privateGetOrdersByClientIdClientOrderId';\n        }\n        const response = await this[method] (this.extend (request, params));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"filledSize\": 10,\n        //             \"future\": \"XRP-PERP\",\n        //             \"id\": 9596912,\n        //             \"market\": \"XRP-PERP\",\n        //             \"price\": 0.306525,\n        //             \"avgFillPrice\": 0.306526,\n        //             \"remainingSize\": 31421,\n        //             \"side\": \"sell\",\n        //             \"size\": 31431,\n        //             \"status\": \"open\",\n        //             \"type\": \"limit\",\n        //             \"reduceOnly\": false,\n        //             \"ioc\": false,\n        //             \"postOnly\": false,\n        //             \"clientId\": null\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return this.parseOrder (result);\n    }\n\n    async fetchOpenOrders (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {};\n        const [ market, marketId ] = this.getMarketParams (symbol, 'market', params);\n        if (marketId !== undefined) {\n            request['market'] = marketId;\n        }\n        // support for canceling conditional orders\n        // https://github.com/ccxt/ccxt/issues/6669\n        const options = this.safeValue (this.options, 'fetchOpenOrders', {});\n        const defaultMethod = this.safeString (options, 'method', 'privateGetOrders');\n        let method = this.safeString (params, 'method', defaultMethod);\n        const type = this.safeValue (params, 'type');\n        if ((type === 'stop') || (type === 'trailingStop') || (type === 'takeProfit')) {\n            method = 'privateGetConditionalOrders';\n        }\n        const query = this.omit (params, [ 'method', 'type' ]);\n        const response = await this[method] (this.extend (request, query));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //                 \"filledSize\": 10,\n        //                 \"future\": \"XRP-PERP\",\n        //                 \"id\": 9596912,\n        //                 \"market\": \"XRP-PERP\",\n        //                 \"price\": 0.306525,\n        //                 \"avgFillPrice\": 0.306526,\n        //                 \"remainingSize\": 31421,\n        //                 \"side\": \"sell\",\n        //                 \"size\": 31431,\n        //                 \"status\": \"open\",\n        //                 \"type\": \"limit\",\n        //                 \"reduceOnly\": false,\n        //                 \"ioc\": false,\n        //                 \"postOnly\": false,\n        //                 \"clientId\": null\n        //             }\n        //         ]\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        return this.parseOrders (result, market, since, limit);\n    }\n\n    async fetchOrders (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {};\n        const [ market, marketId ] = this.getMarketParams (symbol, 'market', params);\n        if (marketId !== undefined) {\n            request['market'] = marketId;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit; // default 100, max 100\n        }\n        if (since !== undefined) {\n            request['start_time'] = parseInt (since / 1000);\n        }\n        // support for canceling conditional orders\n        // https://github.com/ccxt/ccxt/issues/6669\n        const options = this.safeValue (this.options, 'fetchOrders', {});\n        const defaultMethod = this.safeString (options, 'method', 'privateGetOrdersHistory');\n        let method = this.safeString (params, 'method', defaultMethod);\n        const type = this.safeValue (params, 'type');\n        if ((type === 'stop') || (type === 'trailingStop') || (type === 'takeProfit')) {\n            method = 'privateGetConditionalOrdersHistory';\n        }\n        const query = this.omit (params, [ 'method', 'type' ]);\n        const response = await this[method] (this.extend (request, query));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"createdAt\": \"2019-03-05T09:56:55.728933+00:00\",\n        //                 \"filledSize\": 10,\n        //                 \"future\": \"XRP-PERP\",\n        //                 \"id\": 9596912,\n        //                 \"market\": \"XRP-PERP\",\n        //                 \"price\": 0.306525,\n        //                 \"avgFillPrice\": 0.306526,\n        //                 \"remainingSize\": 31421,\n        //                 \"side\": \"sell\",\n        //                 \"size\": 31431,\n        //                 \"status\": \"open\",\n        //                 \"type\": \"limit\",\n        //                 \"reduceOnly\": false,\n        //                 \"ioc\": false,\n        //                 \"postOnly\": false,\n        //                 \"clientId\": null\n        //             }\n        //         ]\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        return this.parseOrders (result, market, since, limit);\n    }\n\n    async fetchMyTrades (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const [ market, marketId ] = this.getMarketParams (symbol, 'market', params);\n        const request = {};\n        if (marketId !== undefined) {\n            request['market'] = marketId;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        if (since !== undefined) {\n            request['start_time'] = parseInt (since / 1000);\n            request['end_time'] = this.seconds ();\n        }\n        const response = await this.privateGetFills (this.extend (request, params));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": [\n        //             {\n        //                 \"fee\": 20.1374935,\n        //                 \"feeRate\": 0.0005,\n        //                 \"future\": \"EOS-0329\",\n        //                 \"id\": 11215,\n        //                 \"liquidity\": \"taker\",\n        //                 \"market\": \"EOS-0329\",\n        //                 \"baseCurrency\": null,\n        //                 \"quoteCurrency\": null,\n        //                 \"orderId\": 8436981,\n        //                 \"price\": 4.201,\n        //                 \"side\": \"buy\",\n        //                 \"size\": 9587,\n        //                 \"time\": \"2019-03-27T19:15:10.204619+00:00\",\n        //                 \"type\": \"order\"\n        //             }\n        //         ]\n        //     }\n        //\n        const trades = this.safeValue (response, 'result', []);\n        return this.parseTrades (trades, market, since, limit);\n    }\n\n    async withdraw (code, amount, address, tag = undefined, params = {}) {\n        await this.loadMarkets ();\n        this.checkAddress (address);\n        const currency = this.currency (code);\n        const request = {\n            'coin': currency['id'],\n            'size': amount,\n            'address': address,\n            // 'password': 'string', // optional withdrawal password if it is required for your account\n            // 'code': '192837', // optional 2fa code if it is required for your account\n        };\n        if (this.password !== undefined) {\n            request['password'] = this.password;\n        }\n        if (tag !== undefined) {\n            request['tag'] = tag;\n        }\n        const response = await this.privatePostWalletWithdrawals (this.extend (request, params));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"coin\": \"USDTBEAR\",\n        //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n        //             \"tag\": \"null\",\n        //             \"fee\": 0,\n        //             \"id\": 1,\n        //             \"size\": \"20.2\",\n        //             \"status\": \"requested\",\n        //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"txid\": \"null\"\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        return this.parseTransaction (result, currency);\n    }\n\n    async fetchPositions (symbols = undefined, params = {}) {\n        await this.loadMarkets ();\n        const response = await this.privateGetAccount (params);\n        //\n        //     {\n        //         \"result\":{\n        //             \"backstopProvider\":false,\n        //             \"chargeInterestOnNegativeUsd\":false,\n        //             \"collateral\":2830.2567913677476,\n        //             \"freeCollateral\":2829.670741867416,\n        //             \"initialMarginRequirement\":0.05,\n        //             \"leverage\":20.0,\n        //             \"liquidating\":false,\n        //             \"maintenanceMarginRequirement\":0.03,\n        //             \"makerFee\":0.0,\n        //             \"marginFraction\":null,\n        //             \"openMarginFraction\":null,\n        //             \"positionLimit\":null,\n        //             \"positionLimitUsed\":null,\n        //             \"positions\":[\n        //                 {\n        //                     \"collateralUsed\":0.0,\n        //                     \"cost\":0.0,\n        //                     \"entryPrice\":null,\n        //                     \"estimatedLiquidationPrice\":null,\n        //                     \"future\":\"XRP-PERP\",\n        //                     \"initialMarginRequirement\":0.05,\n        //                     \"longOrderSize\":0.0,\n        //                     \"maintenanceMarginRequirement\":0.03,\n        //                     \"netSize\":0.0,\n        //                     \"openSize\":0.0,\n        //                     \"realizedPnl\":0.016,\n        //                     \"shortOrderSize\":0.0,\n        //                     \"side\":\"buy\",\n        //                     \"size\":0.0,\n        //                     \"unrealizedPnl\":0.0,\n        //                 }\n        //             ],\n        //             \"spotLendingEnabled\":false,\n        //             \"spotMarginEnabled\":false,\n        //             \"takerFee\":0.0007,\n        //             \"totalAccountValue\":2830.2567913677476,\n        //             \"totalPositionSize\":0.0,\n        //             \"useFttCollateral\":true,\n        //             \"username\":\"igor.kroitor@gmail.com\"\n        //         },\n        //         \"success\":true\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        // todo unify parsePosition/parsePositions\n        return this.safeValue (result, 'positions', []);\n    }\n\n    async fetchDepositAddress (code, params = {}) {\n        await this.loadMarkets ();\n        const currency = this.currency (code);\n        const request = {\n            'coin': currency['id'],\n        };\n        const response = await this.privateGetWalletDepositAddressCoin (this.extend (request, params));\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n        //             \"tag\": \"null\"\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', {});\n        const address = this.safeString (result, 'address');\n        const tag = this.safeString (result, 'tag');\n        this.checkAddress (address);\n        return {\n            'currency': code,\n            'address': address,\n            'tag': tag,\n            'info': response,\n        };\n    }\n\n    parseTransactionStatus (status) {\n        const statuses = {\n            // what are other statuses here?\n            'confirmed': 'ok', // deposits\n            'complete': 'ok', // withdrawals\n        };\n        return this.safeString (statuses, status, status);\n    }\n\n    parseTransaction (transaction, currency = undefined) {\n        //\n        // fetchDeposits\n        //\n        //     airdrop\n        //\n        //     {\n        //         \"id\": 9147072,\n        //         \"coin\": \"SRM_LOCKED\",\n        //         \"size\": 3.12,\n        //         \"time\": \"2021-04-27T23:59:03.565983+00:00\",\n        //         \"notes\": \"SRM Airdrop for FTT holdings\",\n        //         \"status\": \"complete\"\n        //     }\n        //\n        //     regular deposits\n        //\n        //     {\n        //         \"coin\": \"TUSD\",\n        //         \"confirmations\": 64,\n        //         \"confirmedTime\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"fee\": 0,\n        //         \"id\": 1,\n        //         \"sentTime\": \"2019-03-05T09:56:55.735929+00:00\",\n        //         \"size\": \"99.0\",\n        //         \"status\": \"confirmed\",\n        //         \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n        //     }\n        //\n        // fetchWithdrawals\n        //\n        //     {\n        //         \"coin\": \"TUSD\",\n        //         \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n        //         \"tag\": \"null\",\n        //         \"fee\": 0,\n        //         \"id\": 1,\n        //         \"size\": \"99.0\",\n        //         \"status\": \"complete\",\n        //         \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n        //         \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n        //     }\n        //\n        //     {\n        //         \"coin\": 'BTC',\n        //         \"id\": 1969806,\n        //         \"notes\": 'Transfer to Dd6gi7m2Eg4zzBbPAxuwfEaHs6tYvyUX5hbPpsTcNPXo',\n        //         \"size\": 0.003,\n        //         \"status\": 'complete',\n        //         \"time\": '2021-02-03T20:28:54.918146+00:00'\n        //     }\n        //\n        const code = this.safeCurrencyCode (this.safeString (transaction, 'coin'));\n        const id = this.safeString (transaction, 'id');\n        const amount = this.safeNumber (transaction, 'size');\n        const status = this.parseTransactionStatus (this.safeString (transaction, 'status'));\n        const timestamp = this.parse8601 (this.safeString (transaction, 'time'));\n        const txid = this.safeString (transaction, 'txid');\n        let tag = undefined;\n        let address = this.safeValue (transaction, 'address');\n        if (typeof address !== 'string') {\n            tag = this.safeString (address, 'tag');\n            address = this.safeString (address, 'address');\n        }\n        if (address === undefined) {\n            // parse address from internal transfer\n            const notes = this.safeString (transaction, 'notes');\n            if ((notes !== undefined) && (notes.indexOf ('Transfer to') >= 0)) {\n                address = notes.slice (12);\n            }\n        }\n        const fee = this.safeNumber (transaction, 'fee');\n        return {\n            'info': transaction,\n            'id': id,\n            'txid': txid,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'addressFrom': undefined,\n            'address': address,\n            'addressTo': address,\n            'tagFrom': undefined,\n            'tag': tag,\n            'tagTo': tag,\n            'type': undefined,\n            'amount': amount,\n            'currency': code,\n            'status': status,\n            'updated': undefined,\n            'fee': {\n                'currency': code,\n                'cost': fee,\n                'rate': undefined,\n            },\n        };\n    }\n\n    async fetchDeposits (code = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const response = await this.privateGetWalletDeposits (params);\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"coin\": \"TUSD\",\n        //             \"confirmations\": 64,\n        //             \"confirmedTime\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"fee\": 0,\n        //             \"id\": 1,\n        //             \"sentTime\": \"2019-03-05T09:56:55.735929+00:00\",\n        //             \"size\": \"99.0\",\n        //             \"status\": \"confirmed\",\n        //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        let currency = undefined;\n        if (code !== undefined) {\n            currency = this.currency (code);\n        }\n        return this.parseTransactions (result, currency, since, limit, { 'type': 'deposit' });\n    }\n\n    async fetchWithdrawals (code = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const response = await this.privateGetWalletWithdrawals (params);\n        //\n        //     {\n        //         \"success\": true,\n        //         \"result\": {\n        //             \"coin\": \"TUSD\",\n        //             \"address\": \"0x83a127952d266A6eA306c40Ac62A4a70668FE3BE\",\n        //             \"tag\": \"null\",\n        //             \"fee\": 0,\n        //             \"id\": 1,\n        //             \"size\": \"99.0\",\n        //             \"status\": \"complete\",\n        //             \"time\": \"2019-03-05T09:56:55.728933+00:00\",\n        //             \"txid\": \"0x8078356ae4b06a036d64747546c274af19581f1c78c510b60505798a7ffcaf1\"\n        //         }\n        //     }\n        //\n        const result = this.safeValue (response, 'result', []);\n        let currency = undefined;\n        if (code !== undefined) {\n            currency = this.currency (code);\n        }\n        return this.parseTransactions (result, currency, since, limit, { 'type': 'withdrawal' });\n    }\n\n    sign (path, api = 'public', method = 'GET', params = {}, headers = undefined, body = undefined) {\n        let request = '/api/' + this.implodeParams (path, params);\n        const query = this.omit (params, this.extractParams (path));\n        const baseUrl = this.implodeParams (this.urls['api'][api], { 'hostname': this.hostname });\n        let url = baseUrl + request;\n        if (method !== 'POST') {\n            if (Object.keys (query).length) {\n                const suffix = '?' + this.urlencode (query);\n                url += suffix;\n                request += suffix;\n            }\n        }\n        if (api === 'private') {\n            this.checkRequiredCredentials ();\n            const timestamp = this.milliseconds ().toString ();\n            let auth = timestamp + method + request;\n            headers = {};\n            if ((method === 'POST') || (method === 'DELETE')) {\n                body = this.json (query);\n                auth += body;\n                headers['Content-Type'] = 'application/json';\n            }\n            const signature = this.hmac (this.encode (auth), this.encode (this.secret), 'sha256');\n            const options = this.safeValue (this.options, 'sign', {});\n            const headerPrefix = this.safeString (options, this.hostname, 'FTX');\n            const keyField = headerPrefix + '-KEY';\n            const tsField = headerPrefix + '-TS';\n            const signField = headerPrefix + '-SIGN';\n            headers[keyField] = this.apiKey;\n            headers[tsField] = timestamp;\n            headers[signField] = signature;\n        }\n        return { 'url': url, 'method': method, 'body': body, 'headers': headers };\n    }\n\n    handleErrors (code, reason, url, method, headers, body, response, requestHeaders, requestBody) {\n        if (response === undefined) {\n            return; // fallback to the default error handler\n        }\n        //\n        //     {\"error\":\"Invalid parameter start_time\",\"success\":false}\n        //     {\"error\":\"Not enough balances\",\"success\":false}\n        //\n        const success = this.safeValue (response, 'success');\n        if (!success) {\n            const feedback = this.id + ' ' + body;\n            const error = this.safeString (response, 'error');\n            this.throwExactlyMatchedException (this.exceptions['exact'], error, feedback);\n            this.throwBroadlyMatchedException (this.exceptions['broad'], error, feedback);\n            throw new ExchangeError (feedback); // unknown message\n        }\n    }\n};\n"]},"metadata":{},"sourceType":"script"}