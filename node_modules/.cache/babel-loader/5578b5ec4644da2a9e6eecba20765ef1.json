{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\James Price\\\\Documents\\\\VS Code\\\\bixpro\\\\src\\\\views\\\\applications\\\\message\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { createRef, useState, useEffect } from 'react';\nimport { Row, Col, Card, Button, Form } from 'react-bootstrap';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport { ValidationForm, TextInputGroup } from 'react-bootstrap4-form-validation';\nimport Friend from \"./Friends/Friend\";\nimport Messages from \"./Friends/Chat/Messages\";\nimport Search from \"./Search\";\nimport axios from '../../../utils/axios';\n\nconst Message = () => {\n  _s();\n\n  const formRef = /*#__PURE__*/createRef();\n  const [scrollEl, setScrollEl] = useState();\n  const [friend, setFriend] = useState([]);\n  const [chatMsg, setChatMsg] = useState([]);\n  const [user, setUser] = useState({\n    id: 6\n  });\n  const [newMsg, setNewMsg] = useState('');\n\n  const getFriend = async () => {\n    const response = await axios.get('/api/friend/list');\n    setFriend(response.data.friends);\n  };\n\n  const getFriendChat = async (user, scrollEl) => {\n    const response = await axios.get('/api/friend/chat', {\n      params: {\n        id: user.id\n      }\n    });\n    setChatMsg(response.data.messages);\n    const elmnt = document.getElementById(\"main-friend-chat\");\n\n    if (scrollEl) {\n      scrollEl.scrollTop = elmnt.offsetHeight;\n    }\n  };\n\n  useEffect(() => {\n    getFriend();\n    getFriendChat(user, scrollEl);\n  }, [user, scrollEl]);\n\n  const friendListHandler = item => {\n    setUser(item);\n    const elmnt = document.getElementById(\"main-friend-chat\");\n    scrollEl.scrollTop = elmnt.offsetHeight;\n  };\n\n  const friendList = friend.map(f => {\n    return /*#__PURE__*/_jsxDEV(Friend, {\n      data: f,\n      activeId: user.id,\n      clicked: () => friendListHandler(f)\n    }, f.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 16\n    }, this);\n  });\n\n  let message = /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center text-danger\",\n    children: \"Chat Not Found\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 19\n  }, this);\n\n  chatMsg.filter(chats => {\n    message = chats.messages.map((msg, index) => {\n      return /*#__PURE__*/_jsxDEV(Messages, {\n        message: msg,\n        name: user.name,\n        photo: chats.friend_photo\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 20\n      }, this);\n    });\n    return false;\n  });\n\n  const handleSearchChange = async event => {\n    try {\n      event.persist();\n      const {\n        value\n      } = event.target;\n\n      if (value) {\n        const response = await axios.get('/api/friend/search', {\n          params: {\n            query: value\n          }\n        });\n        setFriend(response.data.results);\n      } else {\n        const response = await axios.get('/api/friend/list');\n        setFriend(response.data.friends);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleChange = e => {\n    setNewMsg(e.target.value);\n  };\n\n  const handleSubmit = async (e, formData, inputs) => {\n    e.preventDefault();\n    await axios.post('/api/friend/chat/add', {\n      id: user.id,\n      msg: newMsg\n    }).then(response => {\n      resetForm();\n      setNewMsg('');\n      setChatMsg(response.data.messages);\n      const elmnt = document.getElementById(\"main-friend-chat\");\n      scrollEl.scrollTop = elmnt.offsetHeight;\n    });\n  };\n\n  const resetForm = () => {\n    formRef.current.resetValidationState(true);\n  };\n\n  const handleErrorSubmit = (e, formData, errorInputs) => {//console.log(errorInputs);\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"msg-card\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                xl: 3,\n                md: 12,\n                children: [/*#__PURE__*/_jsxDEV(Search, {\n                  onChange: handleSearchChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-list-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"msg-user-list scroll-div\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"main-friend-list\",\n                      style: {\n                        height: 'calc(100vh - 300px)'\n                      },\n                      children: /*#__PURE__*/_jsxDEV(PerfectScrollbar, {\n                        children: friendList\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 123,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 122,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 121,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                xl: 9,\n                md: 12,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-list-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"msg-user-chat scroll-div\",\n                    style: {\n                      height: 'calc(100vh - 340px)'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(PerfectScrollbar, {\n                      containerRef: ref => {\n                        setScrollEl(ref);\n                      },\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        id: \"main-friend-chat\",\n                        className: \"main-friend-chat\",\n                        children: message\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 134,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 133,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"msg-form\",\n                  children: /*#__PURE__*/_jsxDEV(ValidationForm, {\n                    ref: formRef,\n                    onSubmit: handleSubmit,\n                    onErrorSubmit: handleErrorSubmit,\n                    children: /*#__PURE__*/_jsxDEV(Form.Row, {\n                      children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                        as: Col,\n                        children: /*#__PURE__*/_jsxDEV(TextInputGroup, {\n                          name: \"newMsg\",\n                          id: \"newMsg\",\n                          placeholder: \"Send message\",\n                          required: true,\n                          append: /*#__PURE__*/_jsxDEV(Button, {\n                            type: \"submit\",\n                            variant: \"link\",\n                            className: \"btn-theme btn-icon btn-msg-send\",\n                            children: /*#__PURE__*/_jsxDEV(\"i\", {\n                              className: \"feather icon-play\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 150,\n                              columnNumber: 146\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 150,\n                            columnNumber: 65\n                          }, this),\n                          value: newMsg,\n                          onChange: handleChange,\n                          autoComplete: \"off\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 145,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 144,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 143,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Message, \"A+LBssuvOs0DRW4KN6m2e90FN/Q=\");\n\n_c = Message;\nexport default Message;\n\nvar _c;\n\n$RefreshReg$(_c, \"Message\");","map":{"version":3,"sources":["C:/Users/James Price/Documents/VS Code/bixpro/src/views/applications/message/index.js"],"names":["React","createRef","useState","useEffect","Row","Col","Card","Button","Form","PerfectScrollbar","ValidationForm","TextInputGroup","Friend","Messages","Search","axios","Message","formRef","scrollEl","setScrollEl","friend","setFriend","chatMsg","setChatMsg","user","setUser","id","newMsg","setNewMsg","getFriend","response","get","data","friends","getFriendChat","params","messages","elmnt","document","getElementById","scrollTop","offsetHeight","friendListHandler","item","friendList","map","f","message","filter","chats","msg","index","name","friend_photo","handleSearchChange","event","persist","value","target","query","results","err","console","error","handleChange","e","handleSubmit","formData","inputs","preventDefault","post","then","resetForm","current","resetValidationState","handleErrorSubmit","errorInputs","height","ref"],"mappings":"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","sourcesContent":["import React, { createRef, useState, useEffect } from 'react';\r\nimport { Row, Col, Card, Button, Form } from 'react-bootstrap';\r\nimport PerfectScrollbar from 'react-perfect-scrollbar';\r\nimport { ValidationForm, TextInputGroup } from 'react-bootstrap4-form-validation';\r\n\r\nimport Friend from \"./Friends/Friend\";\r\nimport Messages from \"./Friends/Chat/Messages\";\r\n\r\nimport Search from \"./Search\";\r\n\r\nimport axios from '../../../utils/axios';\r\n\r\nconst Message = () => {\r\n    const formRef = createRef();\r\n    const [scrollEl, setScrollEl] = useState();\r\n\r\n    const [friend, setFriend] = useState([]);\r\n    const [chatMsg, setChatMsg] = useState([]);\r\n    const [user, setUser] = useState({ id: 6 });\r\n    const [newMsg, setNewMsg] = useState('');\r\n\r\n    const getFriend = async () => {\r\n        const response = await axios.get('/api/friend/list');\r\n        setFriend(response.data.friends);\r\n    };\r\n\r\n    const getFriendChat = async (user, scrollEl) => {\r\n        const response = await axios.get('/api/friend/chat', {\r\n            params: {\r\n                id: user.id\r\n            }\r\n        });\r\n        setChatMsg(response.data.messages);\r\n\r\n        const elmnt = document.getElementById(\"main-friend-chat\");\r\n        if (scrollEl) {\r\n            scrollEl.scrollTop = elmnt.offsetHeight;\r\n        }   \r\n    };\r\n\r\n    useEffect(() => {        \r\n        getFriend();\r\n        getFriendChat(user, scrollEl);\r\n    }, [user, scrollEl]);\r\n\r\n    const friendListHandler = (item) => {\r\n        setUser(item);\r\n        const elmnt = document.getElementById(\"main-friend-chat\");\r\n        scrollEl.scrollTop = elmnt.offsetHeight;\r\n    }\r\n\r\n    const friendList = (friend).map(f => {\r\n        return <Friend key={f.id} data={f} activeId={user.id} clicked={() => friendListHandler(f)} />;\r\n    });\r\n\r\n    let message = <div className=\"text-center text-danger\">Chat Not Found</div>;\r\n    chatMsg.filter(chats => {\r\n        message = (chats.messages).map((msg, index) => {\r\n            return <Messages key={index} message={msg} name={user.name} photo={chats.friend_photo} />;\r\n        });\r\n        return false;\r\n    });\r\n\r\n    const handleSearchChange = async (event) => {\r\n        try {\r\n          event.persist();\r\n    \r\n          const { value } = event.target;\r\n          if (value) {\r\n            const response = await axios.get('/api/friend/search', {\r\n                params: {\r\n                    query: value\r\n                }\r\n            });\r\n            setFriend(response.data.results);\r\n          } else {\r\n            const response = await axios.get('/api/friend/list');\r\n            setFriend(response.data.friends);\r\n          }\r\n        } catch (err) {\r\n          console.error(err);\r\n        }\r\n      };\r\n\r\n    const handleChange = (e) => {\r\n        setNewMsg(e.target.value);\r\n    };\r\n\r\n    const handleSubmit = async (e, formData, inputs) => {\r\n        e.preventDefault();\r\n        await axios.post('/api/friend/chat/add', {\r\n            id: user.id,\r\n            msg: newMsg\r\n        }).then(response => {\r\n            resetForm();\r\n            setNewMsg('');\r\n            setChatMsg(response.data.messages);\r\n            const elmnt = document.getElementById(\"main-friend-chat\");\r\n            scrollEl.scrollTop = elmnt.offsetHeight;\r\n        });\r\n    };\r\n\r\n    const resetForm = () => {\r\n        (formRef.current).resetValidationState(true);\r\n    };\r\n\r\n    const handleErrorSubmit = (e, formData, errorInputs) => {\r\n        //console.log(errorInputs);\r\n    };\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Row>\r\n                <Col>\r\n                    <Card className=\"msg-card\">\r\n                        <Card.Body>\r\n                            <Row>\r\n                                <Col xl={3} md={12}>\r\n                                    <Search onChange={handleSearchChange} />\r\n                                    <div className=\"h-list-body\">\r\n                                        <div className=\"msg-user-list scroll-div\">\r\n                                            <div className=\"main-friend-list\" style={{height: 'calc(100vh - 300px)'}}>\r\n                                                <PerfectScrollbar>\r\n                                                    {friendList}\r\n                                                </PerfectScrollbar>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </Col>\r\n                                <Col xl={9} md={12}>\r\n                                    <div className=\"h-list-body\">\r\n                                        <div className=\"msg-user-chat scroll-div\" style={{height: 'calc(100vh - 340px)'}}>\r\n                                            <PerfectScrollbar containerRef={ref => {setScrollEl(ref);}}>\r\n                                                <div id='main-friend-chat' className=\"main-friend-chat\">\r\n                                                    {message}\r\n                                                </div>\r\n                                            </PerfectScrollbar>\r\n                                        </div>\r\n                                    </div>\r\n                                    <hr/>\r\n                                    <div className=\"msg-form\">\r\n                                        <ValidationForm ref={formRef} onSubmit={handleSubmit} onErrorSubmit={handleErrorSubmit}>\r\n                                            <Form.Row>\r\n                                                <Form.Group as={Col}>\r\n                                                    <TextInputGroup\r\n                                                        name=\"newMsg\"\r\n                                                        id=\"newMsg\"\r\n                                                        placeholder=\"Send message\"\r\n                                                        required\r\n                                                        append={<Button type=\"submit\" variant=\"link\" className='btn-theme btn-icon btn-msg-send'><i className=\"feather icon-play\"/></Button>}\r\n                                                        value={newMsg}\r\n                                                        onChange={handleChange}\r\n                                                        autoComplete=\"off\"\r\n                                                    />\r\n                                                </Form.Group>\r\n                                            </Form.Row>\r\n                                        </ValidationForm>\r\n                                    </div>\r\n                                </Col>\r\n                            </Row>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\nexport default Message;"]},"metadata":{},"sourceType":"module"}