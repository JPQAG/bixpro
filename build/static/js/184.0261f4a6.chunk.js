(this["webpackJsonpdatta-able-react-hook"]=this["webpackJsonpdatta-able-react-hook"]||[]).push([[184],{2639:function(e,t,a){"use strict";a.r(t);var c=a(77),n=a.n(c),s=a(109),r=a(29),i=a(1),d=a.n(i),l=a(945),o=a(944),j=a(946),u=a(1249),m=a(316),h=a(51),b=a.n(h),x=a(1376),f=a(9),p=a(918),O=a(2),v=a(0),g=a(308),N=function(e){var t=e.data,a=e.activeId,c=e.clicked,n=g("./".concat(t.photo)),s=["d-block"];s=t.status?[].concat(Object(f.a)(s),["text-c-green"]):[].concat(Object(f.a)(s),["text-muted"]);var r="";t.time&&(r=Object(v.jsx)("small",{className:s.join(" "),children:t.time}));var i="";return t.new&&a!==t.id&&(i=Object(v.jsx)("div",{className:"live-status",children:t.new})),Object(v.jsx)(d.a.Fragment,{children:Object(v.jsxs)(p.a,{className:a===t.id?"userlist-box active":"userlist-box",onClick:c,children:[Object(v.jsxs)(O.b,{to:"#",className:"media-left",children:[" ",Object(v.jsx)("img",{className:"media-object img-radius",src:n.default,alt:t.name}),i]}),Object(v.jsx)(p.a.Body,{children:Object(v.jsxs)("h6",{className:"chat-header",children:[t.name,r]})})]})})},y=a(308),k=function(e){var t=e.message,a=e.photo,c=e.name,n="";t.type&&(n=Object(v.jsx)(O.b,{to:"#",className:"media-left photo-table",children:Object(v.jsx)("img",{className:"media-object img-radius img-radius m-t-5",src:y("./".concat(a)).default,alt:c})}));var s=[];return s=t.type?[].concat(Object(f.a)(s),["chat-menu-content"]):[].concat(Object(f.a)(s),["chat-menu-reply text-muted"]),Object(v.jsx)(d.a.Fragment,{children:Object(v.jsxs)(p.a,{className:"media chat-messages",children:[n,Object(v.jsxs)(p.a.Body,{className:s.join(" "),children:[Object(v.jsx)("div",{className:"",children:Object(v.jsx)("p",{className:"chat-cont",children:t.msg})}),Object(v.jsx)("p",{className:"chat-time",children:t.time})]})]})})},w=function(e){var t=e.onChange;return Object(v.jsx)(d.a.Fragment,{children:Object(v.jsx)("div",{className:"h-list-header m-b-5",children:Object(v.jsxs)("div",{className:"input-group",children:[Object(v.jsx)("input",{type:"text",id:"msg-friends",className:"form-control",placeholder:"Search Friend . . .",onChange:t}),Object(v.jsx)("div",{className:"input-group-append",children:Object(v.jsx)("span",{className:"input-group-text",children:Object(v.jsx)("i",{className:"feather icon-search"})})})]})})})},S=a(304);t.default=function(){var e=Object(i.createRef)(),t=Object(i.useState)(),a=Object(r.a)(t,2),c=a[0],h=a[1],f=Object(i.useState)([]),p=Object(r.a)(f,2),O=p[0],g=p[1],y=Object(i.useState)([]),C=Object(r.a)(y,2),F=C[0],B=C[1],I=Object(i.useState)({id:6}),E=Object(r.a)(I,2),T=E[0],H=E[1],R=Object(i.useState)(""),q=Object(r.a)(R,2),G=q[0],J=q[1],M=function(){var e=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/api/friend/list");case 2:t=e.sent,g(t.data.friends);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(s.a)(n.a.mark((function e(t,a){var c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/api/friend/chat",{params:{id:t.id}});case 2:c=e.sent,B(c.data.messages),s=document.getElementById("main-friend-chat"),a&&(a.scrollTop=s.offsetHeight);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){M(),V(T,c)}),[T,c]);var D=O.map((function(e){return Object(v.jsx)(N,{data:e,activeId:T.id,clicked:function(){return function(e){H(e);var t=document.getElementById("main-friend-chat");c.scrollTop=t.offsetHeight}(e)}},e.id)})),_=Object(v.jsx)("div",{className:"text-center text-danger",children:"Chat Not Found"});F.filter((function(e){return _=e.messages.map((function(t,a){return Object(v.jsx)(k,{message:t,name:T.name,photo:e.friend_photo},a)})),!1}));var z=function(){var e=Object(s.a)(n.a.mark((function e(t){var a,c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.persist(),!(a=t.target.value)){e.next=10;break}return e.next=6,S.a.get("/api/friend/search",{params:{query:a}});case 6:c=e.sent,g(c.data.results),e.next=14;break;case 10:return e.next=12,S.a.get("/api/friend/list");case 12:s=e.sent,g(s.data.friends);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(n.a.mark((function e(t,a,s){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,S.a.post("/api/friend/chat/add",{id:T.id,msg:G}).then((function(e){K(),J(""),B(e.data.messages);var t=document.getElementById("main-friend-chat");c.scrollTop=t.offsetHeight}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}(),K=function(){e.current.resetValidationState(!0)};return Object(v.jsx)(d.a.Fragment,{children:Object(v.jsx)(l.a,{children:Object(v.jsx)(o.a,{children:Object(v.jsx)(j.a,{className:"msg-card",children:Object(v.jsx)(j.a.Body,{children:Object(v.jsxs)(l.a,{children:[Object(v.jsxs)(o.a,{xl:3,md:12,children:[Object(v.jsx)(w,{onChange:z}),Object(v.jsx)("div",{className:"h-list-body",children:Object(v.jsx)("div",{className:"msg-user-list scroll-div",children:Object(v.jsx)("div",{className:"main-friend-list",style:{height:"calc(100vh - 300px)"},children:Object(v.jsx)(b.a,{children:D})})})})]}),Object(v.jsxs)(o.a,{xl:9,md:12,children:[Object(v.jsx)("div",{className:"h-list-body",children:Object(v.jsx)("div",{className:"msg-user-chat scroll-div",style:{height:"calc(100vh - 340px)"},children:Object(v.jsx)(b.a,{containerRef:function(e){h(e)},children:Object(v.jsx)("div",{id:"main-friend-chat",className:"main-friend-chat",children:_})})})}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"msg-form",children:Object(v.jsx)(x.ValidationForm,{ref:e,onSubmit:A,onErrorSubmit:function(e,t,a){},children:Object(v.jsx)(u.a.Row,{children:Object(v.jsx)(u.a.Group,{as:o.a,children:Object(v.jsx)(x.TextInputGroup,{name:"newMsg",id:"newMsg",placeholder:"Send message",required:!0,append:Object(v.jsx)(m.a,{type:"submit",variant:"link",className:"btn-theme btn-icon btn-msg-send",children:Object(v.jsx)("i",{className:"feather icon-play"})}),value:G,onChange:function(e){J(e.target.value)},autoComplete:"off"})})})})})]})]})})})})})})}}}]);
//# sourceMappingURL=184.0261f4a6.chunk.js.map