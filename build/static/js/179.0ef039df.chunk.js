(this["webpackJsonpdatta-able-react-hook"]=this["webpackJsonpdatta-able-react-hook"]||[]).push([[179],{2417:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a(77),s=a.n(n),r=a(109),i=a(29),d=a(1),l=a.n(d),o=a(946),j=a(945),u=a(947),m=a(1228),h=a(316),b=a(51),x=a.n(b),f=a(1341),p=a(9),O=a(919),v=a(2),g=a(308),N=function(e){var t=e.data,a=e.activeId,n=e.clicked,s=g("./".concat(t.photo)),r=["d-block"];r=t.status?[].concat(Object(p.a)(r),["text-c-green"]):[].concat(Object(p.a)(r),["text-muted"]);var i="";t.time&&(i=Object(c.jsx)("small",{className:r.join(" "),children:t.time}));var d="";return t.new&&a!==t.id&&(d=Object(c.jsx)("div",{className:"live-status",children:t.new})),Object(c.jsx)(l.a.Fragment,{children:Object(c.jsxs)(O.a,{className:a===t.id?"userlist-box active":"userlist-box",onClick:n,children:[Object(c.jsxs)(v.b,{to:"#",className:"media-left",children:[" ",Object(c.jsx)("img",{className:"media-object img-radius",src:s.default,alt:t.name}),d]}),Object(c.jsx)(O.a.Body,{children:Object(c.jsxs)("h6",{className:"chat-header",children:[t.name,i]})})]})})},y=a(308),k=function(e){var t=e.message,a=e.photo,n=e.name,s="";t.type&&(s=Object(c.jsx)(v.b,{to:"#",className:"media-left photo-table",children:Object(c.jsx)("img",{className:"media-object img-radius img-radius m-t-5",src:y("./".concat(a)).default,alt:n})}));var r=[];return r=t.type?[].concat(Object(p.a)(r),["chat-menu-content"]):[].concat(Object(p.a)(r),["chat-menu-reply text-muted"]),Object(c.jsx)(l.a.Fragment,{children:Object(c.jsxs)(O.a,{className:"media chat-messages",children:[s,Object(c.jsxs)(O.a.Body,{className:r.join(" "),children:[Object(c.jsx)("div",{className:"",children:Object(c.jsx)("p",{className:"chat-cont",children:t.msg})}),Object(c.jsx)("p",{className:"chat-time",children:t.time})]})]})})},w=function(e){var t=e.onChange;return Object(c.jsx)(l.a.Fragment,{children:Object(c.jsx)("div",{className:"h-list-header m-b-5",children:Object(c.jsxs)("div",{className:"input-group",children:[Object(c.jsx)("input",{type:"text",id:"msg-friends",className:"form-control",placeholder:"Search Friend . . .",onChange:t}),Object(c.jsx)("div",{className:"input-group-append",children:Object(c.jsx)("span",{className:"input-group-text",children:Object(c.jsx)("i",{className:"feather icon-search"})})})]})})})},S=a(304);t.default=function(){var e=Object(d.createRef)(),t=Object(d.useState)(),a=Object(i.a)(t,2),n=a[0],b=a[1],p=Object(d.useState)([]),O=Object(i.a)(p,2),v=O[0],g=O[1],y=Object(d.useState)([]),C=Object(i.a)(y,2),F=C[0],B=C[1],I=Object(d.useState)({id:6}),E=Object(i.a)(I,2),T=E[0],H=E[1],R=Object(d.useState)(""),q=Object(i.a)(R,2),G=q[0],J=q[1],M=function(){var e=Object(r.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/api/friend/list");case 2:t=e.sent,g(t.data.friends);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(r.a)(s.a.mark((function e(t,a){var c,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/api/friend/chat",{params:{id:t.id}});case 2:c=e.sent,B(c.data.messages),n=document.getElementById("main-friend-chat"),a&&(a.scrollTop=n.offsetHeight);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){M(),V(T,n)}),[T,n]);var D=v.map((function(e){return Object(c.jsx)(N,{data:e,activeId:T.id,clicked:function(){return function(e){H(e);var t=document.getElementById("main-friend-chat");n.scrollTop=t.offsetHeight}(e)}},e.id)})),_=Object(c.jsx)("div",{className:"text-center text-danger",children:"Chat Not Found"});F.filter((function(e){return _=e.messages.map((function(t,a){return Object(c.jsx)(k,{message:t,name:T.name,photo:e.friend_photo},a)})),!1}));var z=function(){var e=Object(r.a)(s.a.mark((function e(t){var a,c,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.persist(),!(a=t.target.value)){e.next=10;break}return e.next=6,S.a.get("/api/friend/search",{params:{query:a}});case 6:c=e.sent,g(c.data.results),e.next=14;break;case 10:return e.next=12,S.a.get("/api/friend/list");case 12:n=e.sent,g(n.data.friends);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(r.a)(s.a.mark((function e(t,a,c){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,S.a.post("/api/friend/chat/add",{id:T.id,msg:G}).then((function(e){K(),J(""),B(e.data.messages);var t=document.getElementById("main-friend-chat");n.scrollTop=t.offsetHeight}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}(),K=function(){e.current.resetValidationState(!0)};return Object(c.jsx)(l.a.Fragment,{children:Object(c.jsx)(o.a,{children:Object(c.jsx)(j.a,{children:Object(c.jsx)(u.a,{className:"msg-card",children:Object(c.jsx)(u.a.Body,{children:Object(c.jsxs)(o.a,{children:[Object(c.jsxs)(j.a,{xl:3,md:12,children:[Object(c.jsx)(w,{onChange:z}),Object(c.jsx)("div",{className:"h-list-body",children:Object(c.jsx)("div",{className:"msg-user-list scroll-div",children:Object(c.jsx)("div",{className:"main-friend-list",style:{height:"calc(100vh - 300px)"},children:Object(c.jsx)(x.a,{children:D})})})})]}),Object(c.jsxs)(j.a,{xl:9,md:12,children:[Object(c.jsx)("div",{className:"h-list-body",children:Object(c.jsx)("div",{className:"msg-user-chat scroll-div",style:{height:"calc(100vh - 340px)"},children:Object(c.jsx)(x.a,{containerRef:function(e){b(e)},children:Object(c.jsx)("div",{id:"main-friend-chat",className:"main-friend-chat",children:_})})})}),Object(c.jsx)("hr",{}),Object(c.jsx)("div",{className:"msg-form",children:Object(c.jsx)(f.ValidationForm,{ref:e,onSubmit:A,onErrorSubmit:function(e,t,a){},children:Object(c.jsx)(m.a.Row,{children:Object(c.jsx)(m.a.Group,{as:j.a,children:Object(c.jsx)(f.TextInputGroup,{name:"newMsg",id:"newMsg",placeholder:"Send message",required:!0,append:Object(c.jsx)(h.a,{type:"submit",variant:"link",className:"btn-theme btn-icon btn-msg-send",children:Object(c.jsx)("i",{className:"feather icon-play"})}),value:G,onChange:function(e){J(e.target.value)},autoComplete:"off"})})})})})]})]})})})})})})}}}]);
//# sourceMappingURL=179.0ef039df.chunk.js.map